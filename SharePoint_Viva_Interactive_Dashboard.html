<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharePoint Start and Viva Connections Documentation Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .controls {
            padding: 30px;
            background: white;
            border-bottom: 2px solid #eee;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 16px;
        }

        select {
            width: 100%;
            max-width: 600px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: white;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .content-section {
            padding: 30px;
            min-height: 400px;
        }

        .view-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .view-header h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .view-header p {
            color: #666;
            font-size: 1.1em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
            position: sticky;
            top: 0;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        tr:hover {
            background: #f8f9fa;
        }

        tr:last-child td {
            border-bottom: none;
        }

        td a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.3s;
        }

        td a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-critical { background: #ff6b6b; color: white; }
        .badge-high { background: #f9ca24; color: #333; }
        .badge-medium { background: #00b894; color: white; }
        .badge-low { background: #74b9ff; color: white; }
        .badge-zero { background: #636e72; color: white; }

        .rank-badge {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            line-height: 30px;
            text-align: center;
            font-weight: bold;
            margin-right: 10px;
        }

        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .bar-label {
            min-width: 200px;
            font-weight: 600;
            color: #555;
            flex-shrink: 0;
        }

        .bar {
            height: 30px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.5s;
            position: relative;
            min-width: 150px;
        }

        .bar-value {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: 600;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .highlight-box {
            background: #fff3cd;
            border-left: 4px solid #f9ca24;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .highlight-box strong {
            color: #856404;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            header h1 {
                font-size: 1.8em;
            }

            .view-header h2 {
                font-size: 1.5em;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä SharePoint Start and Viva Connections Documentation Analysis</h1>
            <p>Execution Tracking - 174 Priority Pages</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Viva Connections ‚Ä¢ SharePoint News ‚Ä¢ SharePoint Start | January 2026</p>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">174</div>
                <div class="stat-label">Total Assets</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">69%</div>
                <div class="stat-label">Over 1 Year Old</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">49</div>
                <div class="stat-label">Avg CSAT Score</div>
            </div>
        </div>

        <div class="controls">
            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 0;">
                <button onclick="changeView('execution')" id="tab-execution" style="padding: 12px 24px; background: #667eea; color: white; border: none; border-bottom: 3px solid #667eea; cursor: pointer; font-weight: 600; transition: all 0.3s;">üéØ Execution Plan</button>
            </div>
            <div class="control-group" id="viewSelectorGroup" style="display: none;">
                <label>üîç Select View</label>
                <select id="viewSelector" onchange="changeView()">
                    <option value="ownership">üë• Product Area Ownership - Divide & Conquer</option>
                    <option value="traffic">üî• By Traffic - Top Pages by Views</option>
                    <option value="freshness">‚è∞ By Freshness - Most Outdated Content</option>
                    <option value="csat">üòû By CSAT - Lowest User Satisfaction</option>
                    <option value="never-reviewed">‚ö†Ô∏è Never Reviewed - High Risk Content</option>
                    <option value="sharepoint">üì¶ By Product - SharePoint Only</option>
                    <option value="viva">üéØ By Product - Viva Only</option>
                    <option value="signin">üîê By Theme - Sign In & Authentication</option>
                    <option value="modern">üé® By Theme - Modern Pages & Sites</option>
                    <option value="sharing">ü§ù By Theme - Sharing & Collaboration</option>
                    <option value="lists">üìã By Theme - Lists & Libraries</option>
                </select>
            </div>
        </div>

        <div class="content-section" id="content">
            <!-- Content will be dynamically loaded here -->
        </div>

        <!-- Datalist for owner name suggestions -->
        <datalist id="ownerSuggestions">
        </datalist>
    </div>

    <!-- Load all pages data from external file -->
    <script src="all_pages_data.js"></script>

    <script>
        // Use top 50 from all pages data for backwards compatibility with existing views
        const trafficData = allPagesData.slice(0, 50);

        // Overview data (filtered dataset)
        const themeData = [
            { name: 'powershell', count: 47, pct: 27.0 },
            { name: 'viva', count: 28, pct: 16.1 },
            { name: 'sharepoint', count: 22, pct: 12.6 },
            { name: 'How To', count: 21, pct: 12.1 },
            { name: 'SharePoint pages', count: 11, pct: 6.3 },
            { name: 'SharePoint sites', count: 8, pct: 4.6 },
            { name: 'Get started', count: 6, pct: 3.4 },
            { name: 'Training', count: 6, pct: 3.4 },
            { name: 'SharePoint in Microsoft 365', count: 4, pct: 2.3 },
            { name: 'Templates', count: 4, pct: 2.3 }
        ];

        const freshnessData = [
            { label: '> 365 days (STALE)', count: 55, pct: 68.8, severity: 'critical' },
            { label: '271-365 days', count: 22, pct: 27.5, severity: 'high' },
            { label: '181-270 days', count: 0, pct: 0, severity: 'medium' },
            { label: '91-180 days', count: 2, pct: 2.5, severity: 'medium' },
            { label: '0-90 days (FRESH)', count: 1, pct: 1.2, severity: 'low' }
        ];

        // Helper functions
        function formatNumber(num) {
            return num.toLocaleString();
        }

        function getAgeBadgeClass(age) {
            if (age > 730) return 'badge-critical';
            if (age > 365) return 'badge-high';
            if (age > 180) return 'badge-medium';
            return 'badge-low';
        }

        function getCSATBadgeClass(csat) {
            if (csat === 0 || csat === null) return 'badge-zero';
            if (csat < 40) return 'badge-critical';
            if (csat < 50) return 'badge-high';
            if (csat < 60) return 'badge-medium';
            return 'badge-low';
        }

        // Owner assignment functions
        function getPageOwners() {
            const stored = localStorage.getItem('pageOwners');
            return stored ? JSON.parse(stored) : {};
        }

        function setPageOwner(rank, owner) {
            const owners = getPageOwners();
            owners[rank] = owner.trim();
            localStorage.setItem('pageOwners', JSON.stringify(owners));
        }

        function getAllOwnerNames() {
            const owners = getPageOwners();
            const uniqueNames = [...new Set(Object.values(owners).filter(name => name.length > 0))];
            return uniqueNames.sort();
        }

        function updateOwnerSuggestions() {
            const datalist = document.getElementById('ownerSuggestions');
            if (datalist) {
                const names = getAllOwnerNames();
                datalist.innerHTML = names.map(name => `<option value="${name}">`).join('');
            }
        }

        // Toggle phase expansion/collapse
        function togglePhase(phaseId) {
            const phaseContent = document.getElementById(phaseId);
            const button = document.getElementById(phaseId + '-btn');

            if (phaseContent.style.display === 'none') {
                phaseContent.style.display = 'block';
                button.innerHTML = '‚ñ≤ Collapse';
            } else {
                phaseContent.style.display = 'none';
                button.innerHTML = '‚ñº Expand';
            }
        }

        // Status tracking functions
        function getPageStatuses() {
            const stored = localStorage.getItem('pageStatuses');
            return stored ? JSON.parse(stored) : {};
        }

        function setPageStatus(rank, status) {
            const statuses = getPageStatuses();
            statuses[rank] = status;
            localStorage.setItem('pageStatuses', JSON.stringify(statuses));
        }

        function getStatusBadgeClass(status) {
            const classes = {
                'Not Started': 'badge-zero',
                'In Progress': 'badge-medium',
                'Completed': 'badge-low',
                'Won\'t Do': 'badge-critical'
            };
            return classes[status] || 'badge-zero';
        }

        function getStatusColor(status) {
            const colors = {
                'Not Started': '#95a5a6',
                'In Progress': '#3498db',
                'Completed': '#27ae60',
                'Won\'t Do': '#e74c3c'
            };
            return colors[status] || '#95a5a6';
        }

        // View rendering functions
        function renderOverview() {
            return `
                <div class="view-header">
                    <h2>üìä Overview - Key Metrics</h2>
                    <p>High-level analysis of 174 priority documentation assets (Viva Connections + SharePoint Home/News/Start)</p>
                </div>

                <div class="chart-container">
                    <h3>Content Freshness Distribution</h3>
                    <div class="bar-chart">
                        ${freshnessData.map(item => `
                            <div class="bar-item">
                                <div class="bar-label">${item.label}</div>
                                <div class="bar" style="width: ${item.pct}%;">
                                    <span class="bar-value">${formatNumber(item.count)} (${item.pct}%)</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="highlight-box">
                        <strong>‚ö†Ô∏è Critical Finding:</strong> 55 pages (69% of pages with age data) haven't been updated in over a year
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Top 10 Themes by Asset Count</h3>
                    <div class="bar-chart">
                        ${themeData.map(item => `
                            <div class="bar-item">
                                <div class="bar-label">${item.name}</div>
                                <div class="bar" style="width: ${(item.count / 2251 * 100)}%;">
                                    <span class="bar-value">${formatNumber(item.count)} (${item.pct}%)</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Product Distribution (Filtered Dataset)</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Asset Count</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SharePoint</strong></td>
                                <td>140</td>
                                <td>80.5%</td>
                            </tr>
                            <tr>
                                <td><strong>Viva</strong></td>
                                <td>34</td>
                                <td>19.5%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderExecution() {
            const owners = getPageOwners();
            const statuses = getPageStatuses();

            // Segment pages by category
            const vivaPages = allPagesData.filter(p => p.category === 'Viva Connections');
            const newsPages = allPagesData.filter(p => p.category === 'SharePoint News');
            const startPages = allPagesData.filter(p => p.category === 'SharePoint Start');

            // Calculate coverage for each category
            const vivaTraffic = vivaPages.reduce((sum, p) => sum + p.impressions, 0);
            const newsTraffic = newsPages.reduce((sum, p) => sum + p.impressions, 0);
            const startTraffic = startPages.reduce((sum, p) => sum + p.impressions, 0);
            const totalTraffic = vivaTraffic + newsTraffic + startTraffic;

            // Define category-based sections
            const categories = [
                {
                    title: 'Viva Connections',
                    subtitle: `${vivaPages.length} pages ‚Ä¢ ${(vivaTraffic/1000000).toFixed(1)}M views ‚Ä¢ ${(vivaTraffic/totalTraffic*100).toFixed(0)}% of traffic`,
                    pages: vivaPages,
                    color: '#7cb342'
                },
                {
                    title: 'SharePoint News',
                    subtitle: `${newsPages.length} pages ‚Ä¢ ${(newsTraffic/1000000).toFixed(1)}M views ‚Ä¢ ${(newsTraffic/totalTraffic*100).toFixed(0)}% of traffic`,
                    pages: newsPages,
                    color: '#fb8c00'
                },
                {
                    title: 'SharePoint Start',
                    subtitle: `${startPages.length} pages ‚Ä¢ ${(startTraffic/1000000).toFixed(1)}M views ‚Ä¢ ${(startTraffic/totalTraffic*100).toFixed(0)}% of traffic`,
                    pages: startPages,
                    color: '#e91e63'
                }
            ];

            const renderCategorySection = (category, index) => {
                const categoryPages = category.pages;
                const traffic = categoryPages.reduce((sum, p) => sum + p.impressions, 0);
                const categoryCompleted = categoryPages.filter(p => statuses[p.rank] === 'Completed').length;
                const categoryInProgress = categoryPages.filter(p => statuses[p.rank] === 'In Progress').length;
                const categoryNotStarted = categoryPages.filter(p => (statuses[p.rank] || 'Not Started') === 'Not Started').length;
                const categoryWontDo = categoryPages.filter(p => statuses[p.rank] === "Won't Do").length;
                const categoryCompletionRate = ((categoryCompleted / categoryPages.length) * 100).toFixed(1);
                const categoryId = 'category-' + index;

                return `
                    <div class="chart-container" style="border-left: 6px solid ${category.color};">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <h3 style="color: ${category.color}; margin: 0;">${category.title}</h3>
                            <button
                                onclick="togglePhase('${categoryId}')"
                                style="padding: 8px 16px; background: ${category.color}; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; transition: opacity 0.3s;"
                                onmouseover="this.style.opacity='0.8'"
                                onmouseout="this.style.opacity='1'"
                                id="${categoryId}-btn"
                            >
                                ‚ñº Expand
                            </button>
                        </div>
                        <p style="font-size: 0.95em; color: #666; margin-bottom: 20px;">${category.subtitle}</p>

                        <div id="${categoryId}" style="display: none;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div style="background: linear-gradient(135deg, ${category.color}15 0%, ${category.color}05 100%); padding: 15px; border-radius: 8px; border: 2px solid ${category.color};">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">Pages</div>
                                <div style="font-size: 2em; font-weight: bold; color: ${category.color};">${categoryPages.length}</div>
                            </div>
                            <div style="background: linear-gradient(135deg, ${category.color}15 0%, ${category.color}05 100%); padding: 15px; border-radius: 8px; border: 2px solid ${category.color};">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">Views</div>
                                <div style="font-size: 2em; font-weight: bold; color: ${category.color};">${(traffic / 1000000).toFixed(1)}M</div>
                            </div>
                            <div style="background: #27ae6015; padding: 15px; border-radius: 8px; border: 2px solid #27ae60;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">‚úÖ Done</div>
                                <div style="font-size: 2em; font-weight: bold; color: #27ae60;">${categoryCompleted}</div>
                            </div>
                            <div style="background: #3498db15; padding: 15px; border-radius: 8px; border: 2px solid #3498db;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">üîÑ Progress</div>
                                <div style="font-size: 2em; font-weight: bold; color: #3498db;">${categoryInProgress}</div>
                            </div>
                            <div style="background: #95a5a615; padding: 15px; border-radius: 8px; border: 2px solid #95a5a6;">
                                <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">‚è≥ Not Started</div>
                                <div style="font-size: 2em; font-weight: bold; color: #95a5a6;">${categoryNotStarted}</div>
                            </div>
                        </div>

                        <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
                            <strong>Completion:</strong> ${categoryCompletionRate}%
                            <div style="margin-top: 8px; background: #e0e0e0; height: 12px; border-radius: 6px; overflow: hidden;">
                                <div style="width: ${categoryCompletionRate}%; height: 100%; background: linear-gradient(90deg, #27ae60, #2ecc71);"></div>
                            </div>
                        </div>

                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Page Title</th>
                                    <th>Monthly Views</th>
                                    <th>Days Old</th>
                                    <th>CSAT</th>
                                    <th>Owner</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${categoryPages.map(page => {
                                    const currentOwner = owners[page.rank] || '';
                                    const currentStatus = statuses[page.rank] || 'Not Started';
                                    return `
                                    <tr style="background: ${currentStatus === 'Completed' ? '#e8f5e933' : currentStatus === 'In Progress' ? '#e3f2fd33' : ''};">
                                        <td><span class="rank-badge">${page.rank}</span></td>
                                        <td><strong><a href="${page.url}" target="_blank" style="color: #667eea; text-decoration: none;">${page.title}</a></strong></td>
                                        <td>${formatNumber(page.impressions)}</td>
                                        <td><span class="badge ${getAgeBadgeClass(page.age)}">${page.age || 'N/A'} days</span></td>
                                        <td><span class="badge ${getCSATBadgeClass(page.csat)}">${page.csat || 'N/A'}</span></td>
                                        <td>
                                            <input
                                                type="text"
                                                value="${currentOwner}"
                                                placeholder="Assign owner..."
                                                style="width: 150px; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9em;"
                                                onchange="setPageOwner(${page.rank}, this.value)"
                                                list="ownerSuggestions"
                                            />
                                        </td>
                                        <td>
                                            <select
                                                style="width: 130px; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9em; background-color: ${getStatusColor(currentStatus)}22; color: ${getStatusColor(currentStatus)}; font-weight: 600;"
                                                onchange="setPageStatus(${page.rank}, this.value); changeView();"
                                            >
                                                <option value="Not Started" ${currentStatus === 'Not Started' ? 'selected' : ''}>Not Started</option>
                                                <option value="In Progress" ${currentStatus === 'In Progress' ? 'selected' : ''}>In Progress</option>
                                                <option value="Completed" ${currentStatus === 'Completed' ? 'selected' : ''}>Completed</option>
                                                <option value="Won't Do" ${currentStatus === "Won't Do" ? 'selected' : ''}>Won't Do</option>
                                            </select>
                                        </td>
                                    </tr>
                                `}).join('')}
                            </tbody>
                        </table>
                        </div>
                    </div>
                `;
            };

            return `
                <div class="view-header">
                    <h2>üéØ Execution Plan</h2>
                    <p>Segmented by category with owner assignment and progress tracking</p>
                </div>

                ${categories.map((category, index) => renderCategorySection(category, index)).join('')}
            `;
        }

        function renderPhased() {
            const top50Traffic = trafficData.reduce((sum, p) => sum + p.impressions, 0);
            const totalTraffic = allPagesData.reduce((sum, p) => sum + p.impressions, 0); // Total traffic across all 174 filtered pages

            // Phase boundaries based on cumulative traffic
            const phase1Pages = trafficData.slice(0, 6);  // Pages 1-6 ‚Üí 25.9% coverage
            const phase2Pages = trafficData.slice(6, 25); // Pages 7-25 ‚Üí 40.2% cumulative
            const phase3Pages = trafficData.slice(25, 50); // Pages 26-50 ‚Üí 49.6% cumulative

            const phase1Traffic = phase1Pages.reduce((sum, p) => sum + p.impressions, 0);
            const phase2Traffic = phase2Pages.reduce((sum, p) => sum + p.impressions, 0);
            const phase3Traffic = phase3Pages.reduce((sum, p) => sum + p.impressions, 0);

            const renderPhaseSection = (title, pages, traffic, coverage, color, description) => `
                <div class="chart-container" style="border-left: 6px solid ${color};">
                    <h3 style="color: ${color};">${title}</h3>
                    <p style="font-size: 1.1em; margin-bottom: 20px;">${description}</p>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div style="background: linear-gradient(135deg, ${color}15 0%, ${color}05 100%); padding: 20px; border-radius: 8px; border: 2px solid ${color};">
                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Pages to Update</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: ${color};">${pages.length}</div>
                        </div>
                        <div style="background: linear-gradient(135deg, ${color}15 0%, ${color}05 100%); padding: 20px; border-radius: 8px; border: 2px solid ${color};">
                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Traffic Coverage</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: ${color};">${coverage}%</div>
                        </div>
                        <div style="background: linear-gradient(135deg, ${color}15 0%, ${color}05 100%); padding: 20px; border-radius: 8px; border: 2px solid ${color};">
                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Monthly Views</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: ${color};">${(traffic / 1000000).toFixed(1)}M</div>
                        </div>
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Page Title</th>
                                <th>Monthly Views</th>
                                <th>Days Old</th>
                                <th>CSAT</th>
                                <th>Owner</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${pages.map(page => {
                                const owners = getPageOwners();
                                const statuses = getPageStatuses();
                                const currentOwner = owners[page.rank] || '';
                                const currentStatus = statuses[page.rank] || 'Not Started';
                                return `
                                <tr>
                                    <td><span class="rank-badge">${page.rank}</span></td>
                                    <td><strong><a href="${page.url}" target="_blank" style="color: #667eea; text-decoration: none;">${page.title}</a></strong></td>
                                    <td>${formatNumber(page.impressions)}</td>
                                    <td><span class="badge ${getAgeBadgeClass(page.age)}">${page.age || 'N/A'} days</span></td>
                                    <td><span class="badge ${getCSATBadgeClass(page.csat)}">${page.csat || 'N/A'}</span></td>
                                    <td>
                                        <input
                                            type="text"
                                            value="${currentOwner}"
                                            placeholder="Assign owner..."
                                            style="width: 150px; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9em;"
                                            onchange="setPageOwner(${page.rank}, this.value)"
                                            list="ownerSuggestions"
                                        />
                                    </td>
                                    <td>
                                        <select
                                            style="width: 130px; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9em; background-color: ${getStatusColor(currentStatus)}22; color: ${getStatusColor(currentStatus)}; font-weight: 600;"
                                            onchange="setPageStatus(${page.rank}, this.value); changeView();"
                                        >
                                            <option value="Not Started" ${currentStatus === 'Not Started' ? 'selected' : ''}>Not Started</option>
                                            <option value="In Progress" ${currentStatus === 'In Progress' ? 'selected' : ''}>In Progress</option>
                                            <option value="Completed" ${currentStatus === 'Completed' ? 'selected' : ''}>Completed</option>
                                            <option value="Won't Do" ${currentStatus === "Won't Do" ? 'selected' : ''}>Won't Do</option>
                                        </select>
                                    </td>
                                </tr>
                            `}).join('')}
                        </tbody>
                    </table>
                </div>
            `;

            return `
                <div class="view-header">
                    <h2>üéØ 3-Phase Execution Plan</h2>
                    <p>Strategic phased approach to maximize user impact while managing workload</p>
                </div>

                <div class="highlight-box" style="background: #e8f5e9; border-left-color: #4caf50;">
                    <strong>üí° Strategy:</strong> Focus on highest-impact pages first. Phase 1 reaches 26% of users with just 6 pages.
                    Phase 2 adds 19 pages to reach 40%. Phase 3 completes the top 50 for 50% total coverage.
                </div>

                <div style="background: white; padding: 25px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-top: 0;">üìà Cumulative Progress</h3>
                    <div style="display: flex; gap: 20px; margin-top: 20px;">
                        <div style="flex: 1; text-align: center; padding: 20px; background: #f1f8e9; border-radius: 8px;">
                            <div style="font-size: 3em; font-weight: bold; color: #7cb342;">26%</div>
                            <div style="color: #666;">After Phase 1</div>
                        </div>
                        <div style="flex: 1; text-align: center; padding: 20px; background: #fff3e0; border-radius: 8px;">
                            <div style="font-size: 3em; font-weight: bold; color: #fb8c00;">40%</div>
                            <div style="color: #666;">After Phase 2</div>
                        </div>
                        <div style="flex: 1; text-align: center; padding: 20px; background: #fce4ec; border-radius: 8px;">
                            <div style="font-size: 3em; font-weight: bold; color: #e91e63;">50%</div>
                            <div style="color: #666;">After Phase 3</div>
                        </div>
                    </div>
                </div>

                ${renderPhaseSection(
                    'üöÄ Phase 1: Critical Launch Blockers',
                    phase1Pages,
                    phase1Traffic,
                    '26',
                    '#7cb342',
                    'These 6 pages are your absolute highest priority. Update these BEFORE launch to reach 1 in 4 users.'
                )}

                ${renderPhaseSection(
                    '‚ö° Phase 2: High-Impact Quick Wins',
                    phase2Pages,
                    phase2Traffic,
                    '40',
                    '#fb8c00',
                    'Next 19 pages add significant reach. Complete within 2-3 weeks post-launch to hit 40% coverage.'
                )}

                ${renderPhaseSection(
                    'üì¶ Phase 3: Long Tail Optimization',
                    phase3Pages,
                    phase3Traffic,
                    '50',
                    '#e91e63',
                    'Final 25 pages complete the top 50. Lower individual impact but collectively reaches 50% of all users.'
                )}
            `;
        }

        function renderProgress() {
            const owners = getPageOwners();
            const statuses = getPageStatuses();

            // Group pages by owner
            const ownerStats = {};
            const unassignedPages = [];

            trafficData.forEach(page => {
                const owner = owners[page.rank] || 'Unassigned';
                const status = statuses[page.rank] || 'Not Started';

                if (owner === 'Unassigned') {
                    unassignedPages.push({ ...page, status });
                } else {
                    if (!ownerStats[owner]) {
                        ownerStats[owner] = {
                            total: 0,
                            notStarted: 0,
                            inProgress: 0,
                            completed: 0,
                            wontDo: 0,
                            pages: []
                        };
                    }

                    ownerStats[owner].total++;
                    ownerStats[owner].pages.push({ ...page, status });

                    if (status === 'Not Started') ownerStats[owner].notStarted++;
                    else if (status === 'In Progress') ownerStats[owner].inProgress++;
                    else if (status === 'Completed') ownerStats[owner].completed++;
                    else if (status === "Won't Do") ownerStats[owner].wontDo++;
                }
            });

            // Sort owners by number of pages
            const sortedOwners = Object.keys(ownerStats).sort((a, b) => ownerStats[b].total - ownerStats[a].total);

            return `
                <div class="view-header">
                    <h2>üìà Progress Tracking by Owner</h2>
                    <p>Monitor work distribution and completion status across product managers</p>
                </div>

                ${unassignedPages.length > 0 ? `
                    <div class="highlight-box" style="background: #fff3cd; border-left-color: #f9ca24;">
                        <strong>‚ö†Ô∏è Action Needed:</strong> ${unassignedPages.length} pages still need owner assignment
                    </div>
                ` : `
                    <div class="highlight-box" style="background: #e8f5e9; border-left-color: #4caf50;">
                        <strong>‚úÖ Great!</strong> All pages have been assigned to owners
                    </div>
                `}

                <div style="background: white; padding: 30px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-top: 0;">üìä Overall Progress Summary</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #95a5a622 0%, #95a5a610 100%); border-radius: 8px; border: 2px solid #95a5a6;">
                            <div style="font-size: 2.5em; font-weight: bold; color: #95a5a6;">${Object.values(ownerStats).reduce((sum, o) => sum + o.notStarted, 0)}</div>
                            <div style="color: #666; font-weight: 600; margin-top: 5px;">Not Started</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #3498db22 0%, #3498db10 100%); border-radius: 8px; border: 2px solid #3498db;">
                            <div style="font-size: 2.5em; font-weight: bold; color: #3498db;">${Object.values(ownerStats).reduce((sum, o) => sum + o.inProgress, 0)}</div>
                            <div style="color: #666; font-weight: 600; margin-top: 5px;">In Progress</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #27ae6022 0%, #27ae6010 100%); border-radius: 8px; border: 2px solid #27ae60;">
                            <div style="font-size: 2.5em; font-weight: bold; color: #27ae60;">${Object.values(ownerStats).reduce((sum, o) => sum + o.completed, 0)}</div>
                            <div style="color: #666; font-weight: 600; margin-top: 5px;">Completed</div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #e74c3c22 0%, #e74c3c10 100%); border-radius: 8px; border: 2px solid #e74c3c;">
                            <div style="font-size: 2.5em; font-weight: bold; color: #e74c3c;">${Object.values(ownerStats).reduce((sum, o) => sum + o.wontDo, 0)}</div>
                            <div style="color: #666; font-weight: 600; margin-top: 5px;">Won't Do</div>
                        </div>
                    </div>
                </div>

                ${sortedOwners.map((owner, index) => {
                    const stats = ownerStats[owner];
                    const completionRate = ((stats.completed / stats.total) * 100).toFixed(1);
                    const activeRate = (((stats.inProgress + stats.completed) / stats.total) * 100).toFixed(1);

                    return `
                        <div class="chart-container">
                            <h3>${index + 1}. ${owner} <span style="color: #667eea;">(${stats.total} pages)</span></h3>

                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 25px;">
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #27ae60;">
                                    <strong style="color: #27ae60;">Completion Rate:</strong><br>
                                    <span style="font-size: 1.5em; font-weight: bold;">${completionRate}%</span>
                                    <div style="margin-top: 8px; background: #e0e0e0; height: 8px; border-radius: 4px; overflow: hidden;">
                                        <div style="width: ${completionRate}%; height: 100%; background: linear-gradient(90deg, #27ae60, #2ecc71);"></div>
                                    </div>
                                </div>
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #3498db;">
                                    <strong style="color: #3498db;">Active Rate:</strong><br>
                                    <span style="font-size: 1.5em; font-weight: bold;">${activeRate}%</span>
                                    <div style="margin-top: 8px; background: #e0e0e0; height: 8px; border-radius: 4px; overflow: hidden;">
                                        <div style="width: ${activeRate}%; height: 100%; background: linear-gradient(90deg, #3498db, #5dade2);"></div>
                                    </div>
                                </div>
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #95a5a6;">
                                    <strong style="color: #95a5a6;">Not Started:</strong> ${stats.notStarted}
                                </div>
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #3498db;">
                                    <strong style="color: #3498db;">In Progress:</strong> ${stats.inProgress}
                                </div>
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #27ae60;">
                                    <strong style="color: #27ae60;">Completed:</strong> ${stats.completed}
                                </div>
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #e74c3c;">
                                    <strong style="color: #e74c3c;">Won't Do:</strong> ${stats.wontDo}
                                </div>
                            </div>

                            <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Page Title</th>
                                        <th>Monthly Views</th>
                                        <th>Days Old</th>
                                        <th>CSAT</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${stats.pages.map(page => `
                                        <tr style="background: ${page.status === 'Completed' ? '#e8f5e933' : page.status === 'In Progress' ? '#e3f2fd33' : ''};">
                                            <td><span class="rank-badge">${page.rank}</span></td>
                                            <td><strong><a href="${page.url}" target="_blank" style="color: #667eea; text-decoration: none;">${page.title}</a></strong></td>
                                            <td>${formatNumber(page.impressions)}</td>
                                            <td><span class="badge ${getAgeBadgeClass(page.age)}">${page.age || 'N/A'} days</span></td>
                                            <td><span class="badge ${getCSATBadgeClass(page.csat)}">${page.csat || 'N/A'}</span></td>
                                            <td>
                                                <select
                                                    style="width: 130px; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9em; background-color: ${getStatusColor(page.status)}22; color: ${getStatusColor(page.status)}; font-weight: 600;"
                                                    onchange="setPageStatus(${page.rank}, this.value); changeView();"
                                                >
                                                    <option value="Not Started" ${page.status === 'Not Started' ? 'selected' : ''}>Not Started</option>
                                                    <option value="In Progress" ${page.status === 'In Progress' ? 'selected' : ''}>In Progress</option>
                                                    <option value="Completed" ${page.status === 'Completed' ? 'selected' : ''}>Completed</option>
                                                    <option value="Won't Do" ${page.status === "Won't Do" ? 'selected' : ''}>Won't Do</option>
                                                </select>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                }).join('')}

                ${unassignedPages.length > 0 ? `
                    <div class="chart-container" style="border-left: 6px solid #f39c12;">
                        <h3 style="color: #f39c12;">‚ö†Ô∏è Unassigned Pages (${unassignedPages.length})</h3>
                        <p>These pages need owner assignment in the 3-Phase Execution Plan view</p>

                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Page Title</th>
                                    <th>Monthly Views</th>
                                    <th>Days Old</th>
                                    <th>CSAT</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${unassignedPages.map(page => `
                                    <tr>
                                        <td><span class="rank-badge">${page.rank}</span></td>
                                        <td><strong><a href="${page.url}" target="_blank" style="color: #667eea; text-decoration: none;">${page.title}</a></strong></td>
                                        <td>${formatNumber(page.impressions)}</td>
                                        <td><span class="badge ${getAgeBadgeClass(page.age)}">${page.age || 'N/A'} days</span></td>
                                        <td><span class="badge ${getCSATBadgeClass(page.csat)}">${page.csat || 'N/A'}</span></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                ` : ''}
            `;
        }

        function renderRoadmap() {
            const totalPages = 174;
            const totalTraffic = allPagesData.reduce((sum, p) => sum + p.impressions, 0);

            return `
                <div class="view-header">
                    <h2>üó∫Ô∏è Complete Roadmap to 80% & 100% Coverage</h2>
                    <p>Long-term strategy for comprehensive documentation refresh</p>
                </div>

                <div class="highlight-box" style="background: #e3f2fd; border-left-color: #2196f3;">
                    <strong>‚ö†Ô∏è Reality Check:</strong> Current dashboard shows top 50 pages (50% coverage).
                    Beyond this, diminishing returns make 100% coverage impractical. Focus on 80% as the realistic goal.
                </div>

                <div style="background: white; padding: 30px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-top: 0; color: #2196f3;">üìä Coverage Roadmap Overview</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-top: 25px;">
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #2e7d32;">50%</div>
                            <div style="color: #1b5e20; font-weight: 600; margin-top: 5px;">Top 50 pages</div>
                            <div style="color: #2e7d32; font-size: 0.9em; margin-top: 5px;">‚úÖ Current</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #f57f17;">60%</div>
                            <div style="color: #f57f17; font-weight: 600; margin-top: 5px;">+50 pages (100 total)</div>
                            <div style="color: #f57f17; font-size: 0.9em; margin-top: 5px;">Phase 4</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #ffe0b2 0%, #ffcc80 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #e65100;">70%</div>
                            <div style="color: #e65100; font-weight: 600; margin-top: 5px;">+100 pages (200 total)</div>
                            <div style="color: #e65100; font-size: 0.9em; margin-top: 5px;">Phase 5</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #ffccbc 0%, #ffab91 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #bf360c;">80%</div>
                            <div style="color: #bf360c; font-weight: 600; margin-top: 5px;">+300 pages (500 total)</div>
                            <div style="color: #bf360c; font-size: 0.9em; margin-top: 5px;">Phase 6</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #f8bbd0 0%, #f48fb1 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #880e4f;">100%</div>
                            <div style="color: #880e4f; font-weight: 600; margin-top: 5px;">All 174 pages</div>
                            <div style="color: #880e4f; font-size: 0.9em; margin-top: 5px;">‚ö†Ô∏è Not Recommended</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #7cb342;">
                    <h3 style="color: #7cb342;">‚úÖ PHASES 1-3: COMPLETED (50% Coverage)</h3>
                    <p style="font-size: 1.1em;">First 50 pages - Current dashboard scope</p>
                    <div style="background: #f1f8e9; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 50<br>
                                <strong>Coverage:</strong> 50% of users<br>
                                <strong>Traffic:</strong> 47.3M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 6-8 weeks<br>
                                <strong>Team Size:</strong> 8-10 writers<br>
                                <strong>Status:</strong> <span style="color: #7cb342; font-weight: bold;">‚úÖ Planned</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Excellent<br>
                                <strong>Priority:</strong> Critical<br>
                                <strong>Timeline:</strong> Pre-launch
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #fdd835;">
                    <h3 style="color: #f57f17;">üìã PHASE 4: 60% Coverage (Pages 51-100)</h3>
                    <p style="font-size: 1.1em;">Next 50 pages - Additional 10% coverage</p>
                    <div style="background: #fffde7; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 50 (51-100)<br>
                                <strong>Additional Coverage:</strong> +10%<br>
                                <strong>Additional Traffic:</strong> ~9.5M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 3-4 weeks<br>
                                <strong>Team Size:</strong> 5-6 writers<br>
                                <strong>Status:</strong> <span style="color: #f57f17; font-weight: bold;">üìÖ Future</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Good<br>
                                <strong>Priority:</strong> High<br>
                                <strong>Timeline:</strong> Q1 post-launch
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #ff9800;">
                    <h3 style="color: #e65100;">üìã PHASE 5: 70% Coverage (Pages 101-200)</h3>
                    <p style="font-size: 1.1em;">Next 100 pages - Additional 10% coverage</p>
                    <div style="background: #fff3e0; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 100 (101-200)<br>
                                <strong>Additional Coverage:</strong> +10%<br>
                                <strong>Additional Traffic:</strong> ~9.5M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 6-8 weeks<br>
                                <strong>Team Size:</strong> 5-6 writers<br>
                                <strong>Status:</strong> <span style="color: #e65100; font-weight: bold;">üìÖ Future</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Moderate<br>
                                <strong>Priority:</strong> Medium<br>
                                <strong>Timeline:</strong> Q2 post-launch
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #ff5722;">
                    <h3 style="color: #bf360c;">üìã PHASE 6: 80% Coverage (Pages 201-500)</h3>
                    <p style="font-size: 1.1em;">Next 300 pages - Additional 10% coverage</p>
                    <div style="background: #fbe9e7; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 300 (201-500)<br>
                                <strong>Additional Coverage:</strong> +10%<br>
                                <strong>Additional Traffic:</strong> ~9.5M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 12-16 weeks<br>
                                <strong>Team Size:</strong> 4-5 writers<br>
                                <strong>Status:</strong> <span style="color: #bf360c; font-weight: bold;">üìÖ Future</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Low-Moderate<br>
                                <strong>Priority:</strong> Medium-Low<br>
                                <strong>Timeline:</strong> Q3-Q4 post-launch
                            </div>
                        </div>
                    </div>
                    <div style="background: #fff9c4; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #f57f17;">
                        <strong>üí° Recommended Goal:</strong> This 80% coverage (500 pages) is the optimal stopping point for most teams.
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #e91e63;">
                    <h3 style="color: #880e4f;">‚ö†Ô∏è PHASE 7: 100% Coverage (Pages 140-174)</h3>
                    <p style="font-size: 1.1em;">Remaining 35 pages - Final coverage to 100%</p>
                    <div style="background: #fce4ec; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 35 (140-174)<br>
                                <strong>Additional Coverage:</strong> ~0.1%<br>
                                <strong>Additional Traffic:</strong> Minimal
                            </div>
                            <div>
                                <strong>Effort:</strong> 2-3 YEARS<br>
                                <strong>Team Size:</strong> 10+ writers<br>
                                <strong>Status:</strong> <span style="color: #880e4f; font-weight: bold;">‚ùå Not Viable</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Negative<br>
                                <strong>Priority:</strong> Very Low<br>
                                <strong>Timeline:</strong> Ongoing/Never
                            </div>
                        </div>
                    </div>
                    <div style="background: #ffcdd2; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #d32f2f;">
                        <strong>‚ö†Ô∏è Reality:</strong> These 8,365 pages average <100 views/month each. Many are obsolete, rarely viewed, or duplicate content.
                        Better strategy: Let these age naturally and update only when product changes require it.
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 12px; margin-top: 40px;">
                    <h3 style="color: white; margin-top: 0;">üíé Recommended Strategy</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin-top: 20px;">
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                            <h4 style="color: white; margin-top: 0;">Year 1: Focus on 80%</h4>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Phases 1-3: Top 50 pages (50%)</li>
                                <li>Phase 4: Pages 51-100 (60%)</li>
                                <li>Phase 5: Pages 101-200 (70%)</li>
                                <li>Phase 6: Pages 201-500 (80%)</li>
                            </ul>
                            <strong>Result:</strong> 500 pages updated = 80% coverage
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                            <h4 style="color: white; margin-top: 0;">Year 2+: Maintenance Mode</h4>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Quarterly reviews of top 500</li>
                                <li>Update long tail only when needed</li>
                                <li>Archive truly obsolete content</li>
                                <li>Monitor traffic for rising pages</li>
                            </ul>
                            <strong>Result:</strong> Sustainable, high-ROI approach
                        </div>
                    </div>
                </div>
            `;
        }

        function renderOwnership() {
            // Group pages by theme/feature area
            const areaGroups = {};
            trafficData.forEach(page => {
                if (!areaGroups[page.theme]) {
                    areaGroups[page.theme] = [];
                }
                areaGroups[page.theme].push(page);
            });

            // Calculate metrics for each area
            const areaSummary = Object.keys(areaGroups).map(theme => {
                const pages = areaGroups[theme];
                const totalImpressions = pages.reduce((sum, p) => sum + p.impressions, 0);
                const avgAge = Math.round(pages.reduce((sum, p) => sum + (p.age || 0), 0) / pages.length);
                const avgCSAT = Math.round(pages.reduce((sum, p) => sum + (p.csat || 0), 0) / pages.filter(p => p.csat).length);
                const oldPages = pages.filter(p => (p.age || 0) > 365).length;

                return {
                    theme,
                    pageCount: pages.length,
                    totalImpressions,
                    avgAge,
                    avgCSAT,
                    oldPages,
                    pages: pages.sort((a, b) => b.impressions - a.impressions)
                };
            }).sort((a, b) => b.totalImpressions - a.totalImpressions);

            return `
                <div class="view-header">
                    <h2>üë• Product Area Ownership - Divide & Conquer</h2>
                    <p>Group pages by feature area to assign ownership among product managers</p>
                </div>
                <div class="highlight-box">
                    <strong>üéØ Strategy:</strong> ${areaSummary.length} distinct feature areas identified. Each PM can claim 1-2 areas based on domain expertise.
                </div>

                ${areaSummary.map((area, index) => `
                    <div class="chart-container">
                        <h3>${index + 1}. ${area.theme} <span style="color: #667eea;">(${area.pageCount} pages)</span></h3>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #667eea;">
                                <strong style="color: #667eea;">Total Traffic:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${formatNumber(area.totalImpressions)}</span>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #f39c12;">
                                <strong style="color: #f39c12;">Avg Age:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${area.avgAge} days</span>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #e74c3c;">
                                <strong style="color: #e74c3c;">Stale Pages:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${area.oldPages} / ${area.pageCount}</span>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #27ae60;">
                                <strong style="color: #27ae60;">Avg CSAT:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${area.avgCSAT || 'N/A'}</span>
                            </div>
                        </div>

                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Page Title</th>
                                    <th>Monthly Views</th>
                                    <th>Days Old</th>
                                    <th>CSAT</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${area.pages.slice(0, 10).map((page, idx) => `
                                    <tr>
                                        <td><span class="rank-badge">${idx + 1}</span></td>
                                        <td><strong><a href="${page.url}" target="_blank" style="color: #667eea; text-decoration: none;">${page.title}</a></strong></td>
                                        <td>${formatNumber(page.impressions)}</td>
                                        <td><span class="badge ${getAgeBadgeClass(page.age)}">${page.age || 'N/A'} days</span></td>
                                        <td><span class="badge ${getCSATBadgeClass(page.csat)}">${page.csat || 'N/A'}</span></td>
                                    </tr>
                                `).join('')}
                                ${area.pages.length > 10 ? `
                                    <tr>
                                        <td colspan="5" style="text-align: center; color: #999; font-style: italic;">
                                            ... and ${area.pages.length - 10} more pages in this area
                                        </td>
                                    </tr>
                                ` : ''}
                            </tbody>
                        </table>
                    </div>
                `).join('')}
            `;
        }

        function renderTraffic() {
            return `
                <div class="view-header">
                    <h2>üî• Top 50 Pages by Traffic</h2>
                    <p>Highest impression pages - prioritize for maximum user impact</p>
                </div>
                <div class="highlight-box">
                    <strong>üí° Impact:</strong> These 50 pages capture 49.6% of all documentation traffic
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Product</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${trafficData.map(item => `
                            <tr>
                                <td><span class="rank-badge">${item.rank}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.product}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderFreshness() {
            const oldestPages = [...trafficData].sort((a, b) => (b.age || 0) - (a.age || 0)).slice(0, 50);
            return `
                <div class="view-header">
                    <h2>‚è∞ Top 50 Most Outdated Pages</h2>
                    <p>Oldest content that hasn't been reviewed - highest staleness risk</p>
                </div>
                <div class="highlight-box">
                    <strong>‚ö†Ô∏è Alert:</strong> Average age of these pages is ${Math.round(oldestPages.reduce((sum, p) => sum + (p.age || 0), 0) / oldestPages.length)} days (${(oldestPages.reduce((sum, p) => sum + (p.age || 0), 0) / oldestPages.length / 365).toFixed(1)} years)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Days Old</th>
                            <th>Years Old</th>
                            <th>Monthly Views</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${oldestPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td>${item.age ? (item.age / 365).toFixed(1) : 'N/A'} yrs</td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderCSAT() {
            const lowCSAT = [...trafficData].sort((a, b) => a.csat - b.csat).slice(0, 50);
            return `
                <div class="view-header">
                    <h2>üòû Top 50 Lowest CSAT Pages</h2>
                    <p>Pages with lowest user satisfaction - address user pain points</p>
                </div>
                <div class="highlight-box">
                    <strong>üìâ User Feedback:</strong> Average CSAT of ${Math.round(lowCSAT.reduce((sum, p) => sum + (p.csat || 0), 0) / lowCSAT.length)}/100 indicates significant user dissatisfaction
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>CSAT Score</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${lowCSAT.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}/100</span></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderNeverReviewed() {
            return `
                <div class="view-header">
                    <h2>‚ö†Ô∏è Never Reviewed Content</h2>
                    <p>4,911 pages (55% of all content) have never been reviewed - highest risk</p>
                </div>
                <div class="highlight-box">
                    <strong>üö® Critical Risk:</strong> Over half of all documentation has never undergone a formal review process. These pages represent the highest risk for outdated or inaccurate information.
                </div>
                <div class="chart-container">
                    <h3>Never Reviewed Content Statistics</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Value</th>
                                <th>Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Total Never Reviewed</strong></td>
                                <td>4,911 pages</td>
                                <td>55.4% of all content</td>
                            </tr>
                            <tr>
                                <td><strong>SharePoint Pages</strong></td>
                                <td>4,234 pages</td>
                                <td>55.9% of SharePoint content</td>
                            </tr>
                            <tr>
                                <td><strong>Viva Pages</strong></td>
                                <td>677 pages</td>
                                <td>52.7% of Viva content</td>
                            </tr>
                            <tr>
                                <td><strong>Estimated Age</strong></td>
                                <td>3+ years average</td>
                                <td>High staleness risk</td>
                            </tr>
                            <tr>
                                <td><strong>Recommendation</strong></td>
                                <td colspan="2">Prioritize technical content and high-traffic pages from this group</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="highlight-box">
                    <strong>üìã Next Steps:</strong> Cross-reference never-reviewed pages with high traffic and critical themes to identify immediate priorities
                </div>
            `;
        }

        function renderSharePoint() {
            const spPages = trafficData.filter(p => p.product === 'SharePoint').slice(0, 50);
            return `
                <div class="view-header">
                    <h2>üì¶ SharePoint Content Only</h2>
                    <p>Top 50 SharePoint pages - 7,578 total assets (85.5%)</p>
                </div>
                <div class="highlight-box">
                    <strong>üìä SharePoint Focus:</strong> 85.5% of all documentation is SharePoint-related (7,578 pages)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${spPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderViva() {
            const vivaPages = trafficData.filter(p => p.product === 'Viva');
            return `
                <div class="view-header">
                    <h2>üéØ Viva Content Only</h2>
                    <p>Top Viva pages - 1,285 total assets (14.5%)</p>
                </div>
                <div class="highlight-box">
                    <strong>üéØ Viva Focus:</strong> 1,285 Viva-related pages (14.5% of all documentation)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${vivaPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderSignIn() {
            const signinPages = trafficData.filter(p => p.theme.toLowerCase().includes('sign in') || p.theme.toLowerCase().includes('authentication'));
            return `
                <div class="view-header">
                    <h2>üîê Sign In & Authentication Theme</h2>
                    <p>All pages related to sign-in and authentication</p>
                </div>
                <div class="highlight-box">
                    <strong>üîê Top Theme:</strong> Sign-in pages are among the highest traffic - critical for user experience
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${signinPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderModern() {
            const modernPages = trafficData.filter(p => p.theme.toLowerCase().includes('modern'));
            return `
                <div class="view-header">
                    <h2>üé® Modern Pages & Sites Theme</h2>
                    <p>All pages related to modern SharePoint experience</p>
                </div>
                <div class="highlight-box">
                    <strong>üé® Modern Experience:</strong> These pages cover the modern SharePoint UI and features
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${modernPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderSharing() {
            const sharingPages = trafficData.filter(p => p.theme.toLowerCase().includes('sharing') || p.theme.toLowerCase().includes('collaboration'));
            return `
                <div class="view-header">
                    <h2>ü§ù Sharing & Collaboration Theme</h2>
                    <p>All pages related to sharing files, folders, and collaboration</p>
                </div>
                <div class="highlight-box">
                    <strong>ü§ù Core Feature:</strong> Sharing is a fundamental capability - high traffic and user engagement
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${sharingPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderLists() {
            const listPages = trafficData.filter(p => p.theme.toLowerCase().includes('lists') || p.theme.toLowerCase().includes('libraries'));
            return `
                <div class="view-header">
                    <h2>üìã Lists & Libraries Theme</h2>
                    <p>All pages related to SharePoint lists and document libraries</p>
                </div>
                <div class="highlight-box">
                    <strong>üìã Power User Content:</strong> Lists and libraries are core SharePoint features with significant technical depth
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${listPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // Main view switching function
        function changeView(viewParam) {
            console.log('changeView() called with param:', viewParam);
            const selector = document.getElementById('viewSelector');
            const content = document.getElementById('content');

            // Get view from parameter or selector
            const view = viewParam || (selector ? selector.value : 'overview');
            console.log('Selected view:', view);

            // Update tab styling
            const tabs = ['execution'];
            tabs.forEach(tab => {
                const tabBtn = document.getElementById('tab-' + tab);
                if (tabBtn) {
                    if (tab === view) {
                        tabBtn.style.background = '#667eea';
                        tabBtn.style.color = 'white';
                        tabBtn.style.borderBottom = '3px solid #667eea';
                    } else {
                        tabBtn.style.background = 'white';
                        tabBtn.style.color = '#667eea';
                        tabBtn.style.borderBottom = '3px solid transparent';
                    }
                }
            });

            const viewFunctions = {
                'overview': renderOverview,
                'execution': renderExecution,
                'ownership': renderOwnership,
                'traffic': renderTraffic,
                'freshness': renderFreshness,
                'csat': renderCSAT,
                'never-reviewed': renderNeverReviewed,
                'sharepoint': renderSharePoint,
                'viva': renderViva,
                'signin': renderSignIn,
                'modern': renderModern,
                'sharing': renderSharing,
                'lists': renderLists
            };

            if (viewFunctions[view]) {
                console.log('Rendering view:', view);
                const html = viewFunctions[view]();
                console.log('Generated HTML length:', html.length);
                content.innerHTML = html;
                console.log('Content updated');

                // Update owner suggestions for execution view
                if (view === 'execution') {
                    updateOwnerSuggestions();
                }

                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                console.error('View function not found for:', view);
            }
        }

        // Initialize with execution plan
        window.onload = function() {
            console.log('Window loaded!');
            try {
                const content = document.getElementById('content');
                console.log('Content element:', content);
                console.log('Calling changeView()...');
                changeView('execution');
                console.log('Dashboard loaded successfully!');
            } catch (error) {
                console.error('Error loading dashboard:', error);
            }
        };
    </script>
</body>
</html>
