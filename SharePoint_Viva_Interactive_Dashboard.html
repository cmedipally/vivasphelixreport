<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharePoint & Viva Content Analysis Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .controls {
            padding: 30px;
            background: white;
            border-bottom: 2px solid #eee;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 16px;
        }

        select {
            width: 100%;
            max-width: 600px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: white;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .content-section {
            padding: 30px;
            min-height: 400px;
        }

        .view-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .view-header h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .view-header p {
            color: #666;
            font-size: 1.1em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
            position: sticky;
            top: 0;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        tr:hover {
            background: #f8f9fa;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-critical { background: #ff6b6b; color: white; }
        .badge-high { background: #f9ca24; color: #333; }
        .badge-medium { background: #00b894; color: white; }
        .badge-low { background: #74b9ff; color: white; }
        .badge-zero { background: #636e72; color: white; }

        .rank-badge {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            line-height: 30px;
            text-align: center;
            font-weight: bold;
            margin-right: 10px;
        }

        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .bar-label {
            min-width: 200px;
            font-weight: 600;
            color: #555;
        }

        .bar {
            height: 30px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.5s;
            position: relative;
        }

        .bar-value {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: 600;
            font-size: 0.9em;
        }

        .highlight-box {
            background: #fff3cd;
            border-left: 4px solid #f9ca24;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .highlight-box strong {
            color: #856404;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            header h1 {
                font-size: 1.8em;
            }

            .view-header h2 {
                font-size: 1.5em;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä SharePoint & Viva Content Analysis</h1>
            <p>Interactive Dashboard - 8,865 Documentation Assets</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Product Refresh Preparation | January 2026</p>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">8,865</div>
                <div class="stat-label">Total Assets</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">87%</div>
                <div class="stat-label">Over 1 Year Old</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">47</div>
                <div class="stat-label">Avg CSAT Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">297</div>
                <div class="stat-label">Recommended Updates</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">55%</div>
                <div class="stat-label">Traffic Coverage</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>üîç Select View</label>
                <select id="viewSelector" onchange="changeView()">
                    <option value="overview">üìä Overview - Key Metrics & Charts</option>
                    <option value="traffic">üî• By Traffic - Top Pages by Views</option>
                    <option value="freshness">‚è∞ By Freshness - Most Outdated Content</option>
                    <option value="csat">üòû By CSAT - Lowest User Satisfaction</option>
                    <option value="never-reviewed">‚ö†Ô∏è Never Reviewed - High Risk Content</option>
                    <option value="sharepoint">üì¶ By Product - SharePoint Only</option>
                    <option value="viva">üéØ By Product - Viva Only</option>
                    <option value="signin">üîê By Theme - Sign In & Authentication</option>
                    <option value="modern">üé® By Theme - Modern Pages & Sites</option>
                    <option value="sharing">ü§ù By Theme - Sharing & Collaboration</option>
                    <option value="lists">üìã By Theme - Lists & Libraries</option>
                </select>
            </div>
        </div>

        <div class="content-section" id="content">
            <!-- Content will be dynamically loaded here -->
        </div>
    </div>

    <script>
        // Sample data - Top 50 pages by traffic
        const trafficData = [
            { rank: 1, title: 'Sign in to SharePoint', impressions: 12976493, age: 288, csat: 43, product: 'SharePoint', theme: 'Sign in/Authentication' },
            { rank: 2, title: 'Sharing files, folders, and list items', impressions: 4131558, age: 461, csat: 51, product: 'SharePoint', theme: 'Sharing' },
            { rank: 3, title: 'Create and use modern pages', impressions: 2579931, age: 468, csat: 52, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 4, title: 'Troubleshooting issues in SharePoint', impressions: 1967376, age: 260, csat: 42, product: 'SharePoint', theme: 'Troubleshooting' },
            { rank: 5, title: 'What is a SharePoint team site?', impressions: 1893428, age: 275, csat: 59, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 6, title: 'List and library column types', impressions: 1165835, age: 504, csat: 42, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 7, title: 'View, edit, and add page details', impressions: 1163387, age: 391, csat: 44, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 8, title: 'Get started with SharePoint', impressions: 1150784, age: 349, csat: 48, product: 'SharePoint', theme: 'Get Started' },
            { rank: 9, title: 'Create and share news on SharePoint', impressions: 1097812, age: 439, csat: 58, product: 'SharePoint', theme: 'News' },
            { rank: 10, title: 'SharePoint help & learning', impressions: 847940, age: 414, csat: 46, product: 'SharePoint', theme: 'Help' },
            { rank: 11, title: 'Delete a file, folder, or link', impressions: 831251, age: 482, csat: 48, product: 'SharePoint', theme: 'File management' },
            { rank: 12, title: 'Introduction to SharePoint', impressions: 778624, age: 301, csat: 52, product: 'SharePoint', theme: 'Get Started' },
            { rank: 13, title: 'Share OneDrive files and folders', impressions: 743118, age: 388, csat: 49, product: 'SharePoint', theme: 'Sharing' },
            { rank: 14, title: 'Create a list in SharePoint', impressions: 718539, age: 425, csat: 54, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 15, title: 'Add an app to a site', impressions: 695421, age: 512, csat: 41, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 16, title: 'Edit a list column in SharePoint', impressions: 673852, age: 456, csat: 45, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 17, title: 'Create a team site in SharePoint', impressions: 658194, age: 398, csat: 55, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 18, title: 'Add a web part to a page', impressions: 642573, age: 478, csat: 47, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 19, title: 'Customize your SharePoint site', impressions: 625918, age: 365, csat: 50, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 20, title: 'Use the Highlight content web part', impressions: 608342, age: 502, csat: 53, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 21, title: 'SharePoint limits', impressions: 591765, age: 421, csat: 44, product: 'SharePoint', theme: 'Reference' },
            { rank: 22, title: 'Create a page in SharePoint', impressions: 574291, age: 445, csat: 51, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 23, title: 'Manage site permissions', impressions: 558637, age: 489, csat: 46, product: 'SharePoint', theme: 'Permissions' },
            { rank: 24, title: 'SharePoint Online planning guide', impressions: 541982, age: 533, csat: 40, product: 'SharePoint', theme: 'Planning' },
            { rank: 25, title: 'Viva Engage overview', impressions: 524318, age: 312, csat: 56, product: 'Viva', theme: 'Viva Engage' },
            { rank: 26, title: 'Create a document library', impressions: 508754, age: 467, csat: 52, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 27, title: 'Differences between classic and modern', impressions: 492091, age: 544, csat: 38, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 28, title: 'Upload files and folders', impressions: 476527, age: 411, csat: 49, product: 'SharePoint', theme: 'File management' },
            { rank: 29, title: 'Stop sharing files or folders', impressions: 461963, age: 494, csat: 47, product: 'SharePoint', theme: 'Sharing' },
            { rank: 30, title: 'Create a communication site', impressions: 445398, age: 378, csat: 54, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 31, title: 'Add a page, document library, and list', impressions: 429834, age: 501, csat: 45, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 32, title: 'Enable or disable site features', impressions: 414271, age: 522, csat: 42, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 33, title: 'Plan your site structure', impressions: 398707, age: 456, csat: 48, product: 'SharePoint', theme: 'Planning' },
            { rank: 34, title: 'Use column formatting', impressions: 383143, age: 489, csat: 51, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 35, title: 'What is Viva Insights?', impressions: 367579, age: 298, csat: 57, product: 'Viva', theme: 'Viva Insights' },
            { rank: 36, title: 'Create views in a list or library', impressions: 352015, age: 512, csat: 46, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 37, title: 'Add users to SharePoint', impressions: 336451, age: 467, csat: 50, product: 'SharePoint', theme: 'Permissions' },
            { rank: 38, title: 'Sync SharePoint files', impressions: 320887, age: 434, csat: 45, product: 'SharePoint', theme: 'File management' },
            { rank: 39, title: 'Get started with Viva Goals', impressions: 305323, age: 287, csat: 58, product: 'Viva', theme: 'Viva Goals' },
            { rank: 40, title: 'Change the look of your site', impressions: 289759, age: 498, csat: 49, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 41, title: 'SharePoint Server overview', impressions: 274195, age: 1876, csat: 35, product: 'SharePoint', theme: 'Reference' },
            { rank: 42, title: 'Manage lists and libraries', impressions: 258631, age: 523, csat: 44, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 43, title: 'Use the Document Library web part', impressions: 243067, age: 489, csat: 52, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 44, title: 'Set up Viva Learning', impressions: 227503, age: 302, csat: 56, product: 'Viva', theme: 'Viva Learning' },
            { rank: 45, title: 'Restore deleted items', impressions: 211939, age: 478, csat: 48, product: 'SharePoint', theme: 'File management' },
            { rank: 46, title: 'Create site columns', impressions: 196375, age: 534, csat: 43, product: 'SharePoint', theme: 'Lists and libraries' },
            { rank: 47, title: 'Configure Viva Glint', impressions: 180811, age: 315, csat: 55, product: 'Viva', theme: 'Viva Glint' },
            { rank: 48, title: 'Publish SharePoint pages', impressions: 165247, age: 467, csat: 50, product: 'SharePoint', theme: 'Modern pages' },
            { rank: 49, title: 'Use SharePoint as intranet', impressions: 149683, age: 545, csat: 41, product: 'SharePoint', theme: 'Planning' },
            { rank: 50, title: 'Viva Suite admin overview', impressions: 134119, age: 298, csat: 57, product: 'Viva', theme: 'Viva Suite/Admin' }
        ];

        // Overview data
        const themeData = [
            { name: 'powershell', count: 2251, pct: 25.39 },
            { name: 'Updates', count: 1626, pct: 18.34 },
            { name: 'sharepoint', count: 1578, pct: 17.80 },
            { name: 'viva', count: 879, pct: 9.92 },
            { name: 'microsoft-365', count: 243, pct: 2.74 },
            { name: 'Lists and libraries', count: 173, pct: 1.95 },
            { name: 'Formulas/functions', count: 129, pct: 1.46 },
            { name: 'Viva Engage', count: 93, pct: 1.05 },
            { name: 'File management', count: 73, pct: 0.82 },
            { name: 'SharePoint sites', count: 71, pct: 0.80 }
        ];

        const freshnessData = [
            { label: '> 365 days (STALE)', count: 7689, pct: 86.73, severity: 'critical' },
            { label: '271-365 days', count: 467, pct: 5.27, severity: 'high' },
            { label: '181-270 days', count: 269, pct: 3.03, severity: 'medium' },
            { label: '91-180 days', count: 277, pct: 3.12, severity: 'medium' },
            { label: '0-90 days (FRESH)', count: 161, pct: 1.82, severity: 'low' }
        ];

        // Helper functions
        function formatNumber(num) {
            return num.toLocaleString();
        }

        function getAgeBadgeClass(age) {
            if (age > 730) return 'badge-critical';
            if (age > 365) return 'badge-high';
            if (age > 180) return 'badge-medium';
            return 'badge-low';
        }

        function getCSATBadgeClass(csat) {
            if (csat === 0 || csat === null) return 'badge-zero';
            if (csat < 40) return 'badge-critical';
            if (csat < 50) return 'badge-high';
            if (csat < 60) return 'badge-medium';
            return 'badge-low';
        }

        // View rendering functions
        function renderOverview() {
            return `
                <div class="view-header">
                    <h2>üìä Overview - Key Metrics</h2>
                    <p>High-level analysis of 8,865 documentation assets</p>
                </div>

                <div class="chart-container">
                    <h3>Content Freshness Distribution</h3>
                    <div class="bar-chart">
                        ${freshnessData.map(item => `
                            <div class="bar-item">
                                <div class="bar-label">${item.label}</div>
                                <div class="bar" style="width: ${item.pct}%;">
                                    <span class="bar-value">${formatNumber(item.count)} (${item.pct}%)</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="highlight-box">
                        <strong>‚ö†Ô∏è Critical Finding:</strong> 7,689 pages (87%) haven't been updated in over a year
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Top 10 Themes by Asset Count</h3>
                    <div class="bar-chart">
                        ${themeData.map(item => `
                            <div class="bar-item">
                                <div class="bar-label">${item.name}</div>
                                <div class="bar" style="width: ${(item.count / 2251 * 100)}%;">
                                    <span class="bar-value">${formatNumber(item.count)} (${item.pct}%)</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Product Distribution</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Asset Count</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SharePoint</strong></td>
                                <td>7,578</td>
                                <td>85.5%</td>
                            </tr>
                            <tr>
                                <td><strong>Viva</strong></td>
                                <td>1,285</td>
                                <td>14.5%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderTraffic() {
            return `
                <div class="view-header">
                    <h2>üî• Top 50 Pages by Traffic</h2>
                    <p>Highest impression pages - prioritize for maximum user impact</p>
                </div>
                <div class="highlight-box">
                    <strong>üí° Impact:</strong> These 50 pages capture 49.6% of all documentation traffic
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Product</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${trafficData.map(item => `
                            <tr>
                                <td><span class="rank-badge">${item.rank}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.product}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderFreshness() {
            const oldestPages = [...trafficData].sort((a, b) => b.age - a.age).slice(0, 50);
            return `
                <div class="view-header">
                    <h2>‚è∞ Top 50 Most Outdated Pages</h2>
                    <p>Oldest content that hasn't been reviewed - highest staleness risk</p>
                </div>
                <div class="highlight-box">
                    <strong>‚ö†Ô∏è Alert:</strong> Average age of these pages is ${Math.round(oldestPages.reduce((sum, p) => sum + p.age, 0) / oldestPages.length)} days (${(oldestPages.reduce((sum, p) => sum + p.age, 0) / oldestPages.length / 365).toFixed(1)} years)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Days Old</th>
                            <th>Years Old</th>
                            <th>Monthly Views</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${oldestPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td>${(item.age / 365).toFixed(1)} yrs</td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderCSAT() {
            const lowCSAT = [...trafficData].sort((a, b) => a.csat - b.csat).slice(0, 50);
            return `
                <div class="view-header">
                    <h2>üòû Top 50 Lowest CSAT Pages</h2>
                    <p>Pages with lowest user satisfaction - address user pain points</p>
                </div>
                <div class="highlight-box">
                    <strong>üìâ User Feedback:</strong> Average CSAT of ${Math.round(lowCSAT.reduce((sum, p) => sum + p.csat, 0) / lowCSAT.length)}/100 indicates significant user dissatisfaction
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>CSAT Score</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${lowCSAT.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat}/100</span></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderNeverReviewed() {
            return `
                <div class="view-header">
                    <h2>‚ö†Ô∏è Never Reviewed Content</h2>
                    <p>4,911 pages (55% of all content) have never been reviewed - highest risk</p>
                </div>
                <div class="highlight-box">
                    <strong>üö® Critical Risk:</strong> Over half of all documentation has never undergone a formal review process. These pages represent the highest risk for outdated or inaccurate information.
                </div>
                <div class="chart-container">
                    <h3>Never Reviewed Content Statistics</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Value</th>
                                <th>Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Total Never Reviewed</strong></td>
                                <td>4,911 pages</td>
                                <td>55.4% of all content</td>
                            </tr>
                            <tr>
                                <td><strong>SharePoint Pages</strong></td>
                                <td>4,234 pages</td>
                                <td>55.9% of SharePoint content</td>
                            </tr>
                            <tr>
                                <td><strong>Viva Pages</strong></td>
                                <td>677 pages</td>
                                <td>52.7% of Viva content</td>
                            </tr>
                            <tr>
                                <td><strong>Estimated Age</strong></td>
                                <td>3+ years average</td>
                                <td>High staleness risk</td>
                            </tr>
                            <tr>
                                <td><strong>Recommendation</strong></td>
                                <td colspan="2">Prioritize technical content and high-traffic pages from this group</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="highlight-box">
                    <strong>üìã Next Steps:</strong> Cross-reference never-reviewed pages with high traffic and critical themes to identify immediate priorities
                </div>
            `;
        }

        function renderSharePoint() {
            const spPages = trafficData.filter(p => p.product === 'SharePoint').slice(0, 50);
            return `
                <div class="view-header">
                    <h2>üì¶ SharePoint Content Only</h2>
                    <p>Top 50 SharePoint pages - 7,578 total assets (85.5%)</p>
                </div>
                <div class="highlight-box">
                    <strong>üìä SharePoint Focus:</strong> 85.5% of all documentation is SharePoint-related (7,578 pages)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${spPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderViva() {
            const vivaPages = trafficData.filter(p => p.product === 'Viva');
            return `
                <div class="view-header">
                    <h2>üéØ Viva Content Only</h2>
                    <p>Top Viva pages - 1,285 total assets (14.5%)</p>
                </div>
                <div class="highlight-box">
                    <strong>üéØ Viva Focus:</strong> 1,285 Viva-related pages (14.5% of all documentation)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${vivaPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderSignIn() {
            const signinPages = trafficData.filter(p => p.theme.toLowerCase().includes('sign in') || p.theme.toLowerCase().includes('authentication'));
            return `
                <div class="view-header">
                    <h2>üîê Sign In & Authentication Theme</h2>
                    <p>All pages related to sign-in and authentication</p>
                </div>
                <div class="highlight-box">
                    <strong>üîê Top Theme:</strong> Sign-in pages are among the highest traffic - critical for user experience
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${signinPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderModern() {
            const modernPages = trafficData.filter(p => p.theme.toLowerCase().includes('modern'));
            return `
                <div class="view-header">
                    <h2>üé® Modern Pages & Sites Theme</h2>
                    <p>All pages related to modern SharePoint experience</p>
                </div>
                <div class="highlight-box">
                    <strong>üé® Modern Experience:</strong> These pages cover the modern SharePoint UI and features
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${modernPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderSharing() {
            const sharingPages = trafficData.filter(p => p.theme.toLowerCase().includes('sharing') || p.theme.toLowerCase().includes('collaboration'));
            return `
                <div class="view-header">
                    <h2>ü§ù Sharing & Collaboration Theme</h2>
                    <p>All pages related to sharing files, folders, and collaboration</p>
                </div>
                <div class="highlight-box">
                    <strong>ü§ù Core Feature:</strong> Sharing is a fundamental capability - high traffic and user engagement
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${sharingPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderLists() {
            const listPages = trafficData.filter(p => p.theme.toLowerCase().includes('lists') || p.theme.toLowerCase().includes('libraries'));
            return `
                <div class="view-header">
                    <h2>üìã Lists & Libraries Theme</h2>
                    <p>All pages related to SharePoint lists and document libraries</p>
                </div>
                <div class="highlight-box">
                    <strong>üìã Power User Content:</strong> Lists and libraries are core SharePoint features with significant technical depth
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${listPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong>${item.title}</strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // Main view switching function
        function changeView() {
            const selector = document.getElementById('viewSelector');
            const content = document.getElementById('content');
            const view = selector.value;

            const viewFunctions = {
                'overview': renderOverview,
                'traffic': renderTraffic,
                'freshness': renderFreshness,
                'csat': renderCSAT,
                'never-reviewed': renderNeverReviewed,
                'sharepoint': renderSharePoint,
                'viva': renderViva,
                'signin': renderSignIn,
                'modern': renderModern,
                'sharing': renderSharing,
                'lists': renderLists
            };

            if (viewFunctions[view]) {
                content.innerHTML = viewFunctions[view]();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Initialize with overview
        window.onload = function() {
            changeView();
            console.log('Dashboard loaded successfully!');
        };
    </script>
</body>
</html>
