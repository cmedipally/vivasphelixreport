<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharePoint & Viva Content Analysis Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .controls {
            padding: 30px;
            background: white;
            border-bottom: 2px solid #eee;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 16px;
        }

        select {
            width: 100%;
            max-width: 600px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: white;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .content-section {
            padding: 30px;
            min-height: 400px;
        }

        .view-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .view-header h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .view-header p {
            color: #666;
            font-size: 1.1em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
            position: sticky;
            top: 0;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        tr:hover {
            background: #f8f9fa;
        }

        tr:last-child td {
            border-bottom: none;
        }

        td a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.3s;
        }

        td a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-critical { background: #ff6b6b; color: white; }
        .badge-high { background: #f9ca24; color: #333; }
        .badge-medium { background: #00b894; color: white; }
        .badge-low { background: #74b9ff; color: white; }
        .badge-zero { background: #636e72; color: white; }

        .rank-badge {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            line-height: 30px;
            text-align: center;
            font-weight: bold;
            margin-right: 10px;
        }

        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .bar-label {
            min-width: 200px;
            font-weight: 600;
            color: #555;
            flex-shrink: 0;
        }

        .bar {
            height: 30px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.5s;
            position: relative;
            min-width: 150px;
        }

        .bar-value {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: 600;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .highlight-box {
            background: #fff3cd;
            border-left: 4px solid #f9ca24;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .highlight-box strong {
            color: #856404;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            header h1 {
                font-size: 1.8em;
            }

            .view-header h2 {
                font-size: 1.5em;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä SharePoint & Viva Content Analysis</h1>
            <p>Interactive Dashboard - 8,865 Documentation Assets</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Product Refresh Preparation | January 2026</p>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">8,865</div>
                <div class="stat-label">Total Assets</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">87%</div>
                <div class="stat-label">Over 1 Year Old</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">47</div>
                <div class="stat-label">Avg CSAT Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">297</div>
                <div class="stat-label">Recommended Updates</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">55%</div>
                <div class="stat-label">Traffic Coverage</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>üîç Select View</label>
                <select id="viewSelector" onchange="changeView()">
                    <option value="overview">üìä Overview - Key Metrics & Charts</option>
                    <option value="phased">üéØ 3-Phase Execution Plan - 25% ‚Üí 40% ‚Üí 50%</option>
                    <option value="roadmap">üó∫Ô∏è Complete Roadmap - Path to 80% & 100%</option>
                    <option value="ownership">üë• Product Area Ownership - Divide & Conquer</option>
                    <option value="traffic">üî• By Traffic - Top Pages by Views</option>
                    <option value="freshness">‚è∞ By Freshness - Most Outdated Content</option>
                    <option value="csat">üòû By CSAT - Lowest User Satisfaction</option>
                    <option value="never-reviewed">‚ö†Ô∏è Never Reviewed - High Risk Content</option>
                    <option value="sharepoint">üì¶ By Product - SharePoint Only</option>
                    <option value="viva">üéØ By Product - Viva Only</option>
                    <option value="signin">üîê By Theme - Sign In & Authentication</option>
                    <option value="modern">üé® By Theme - Modern Pages & Sites</option>
                    <option value="sharing">ü§ù By Theme - Sharing & Collaboration</option>
                    <option value="lists">üìã By Theme - Lists & Libraries</option>
                </select>
            </div>
        </div>

        <div class="content-section" id="content">
            <!-- Content will be dynamically loaded here -->
        </div>

        <!-- Datalist for owner name suggestions -->
        <datalist id="ownerSuggestions">
        </datalist>
    </div>

    <script>
        // Sample data - Top 50 pages by traffic with real URLs
        const trafficData = [
            { rank: 1, title: 'Sign in to SharePoint', url: 'https://support.microsoft.com/en-us/topic/324a89ec-e77b-4475-b64a-13a0c14c45ec', impressions: 12976493, age: 288, csat: 43, product: 'SharePoint', theme: 'Sign in' },
            { rank: 2, title: 'Sharing files, folders, and list items', url: 'https://support.microsoft.com/en-us/topic/74cab0bf-39c6-4112-a63f-88ee121722d0', impressions: 4131558, age: 461, csat: 51, product: 'SharePoint', theme: 'Collaborate and share' },
            { rank: 3, title: 'Create and use modern pages on a SharePoint site', url: 'https://support.microsoft.com/en-us/topic/b3d46deb-27a6-4b1e-87b8-df851e503dec', impressions: 2579931, age: 468, csat: 52, product: 'SharePoint', theme: 'SharePoint pages' },
            { rank: 4, title: 'Troubleshooting issues in SharePoint', url: 'https://support.microsoft.com/en-us/topic/dc656f67-fec3-4948-9ec2-5e1b51886964', impressions: 1967376, age: 260, csat: 42, product: 'SharePoint', theme: 'Troubleshooting' },
            { rank: 5, title: 'What is a SharePoint team site?', url: 'https://support.microsoft.com/en-us/topic/75545757-36c3-46a7-beed-0aaa74f0401e', impressions: 1893428, age: 275, csat: 59, product: 'SharePoint', theme: 'Templates' },
            { rank: 6, title: 'List and library column types and options', url: 'https://support.microsoft.com/en-us/topic/0d8ddb7b-7dc7-414d-a283-ee9dca891df7', impressions: 1165835, age: 504, csat: 42, product: 'SharePoint', theme: 'SharePoint lists and libraries' },
            { rank: 7, title: 'View, edit, and add page details', url: 'https://support.microsoft.com/en-us/topic/778018d3-8269-4fd2-a55d-8c0e5b72b938', impressions: 1163387, age: 391, csat: 44, product: 'SharePoint', theme: 'SharePoint pages' },
            { rank: 8, title: 'Get started with SharePoint', url: 'https://support.microsoft.com/en-us/topic/909ec2f0-05c8-4e92-8ad3-3f8b0b6cf261', impressions: 1150784, age: 349, csat: 48, product: 'SharePoint', theme: 'Get started' },
            { rank: 9, title: 'Create and share news on your SharePoint sites', url: 'https://support.microsoft.com/en-us/topic/495f8f1a-3bef-4045-b33a-55e5abe7aed7', impressions: 1097812, age: 439, csat: 58, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 10, title: 'SharePoint help', url: 'https://support.microsoft.com/en-us/topic/83c1c11b-3d7c-4852-b597-46309e0892b3', impressions: 847940, age: 414, csat: 46, product: 'SharePoint', theme: 'Help' },
            { rank: 11, title: 'Use the Highlighted content web part', url: 'https://support.microsoft.com/en-us/topic/e34199b0-ff1a-47fb-8f4d-dbcaed329efd', impressions: 834545, age: 328, csat: 51, product: 'SharePoint', theme: 'SharePoint web parts' },
            { rank: 12, title: 'Schedule send in Outlook', url: 'https://support.microsoft.com/en-us/topic/0b0c0c20-8fa1-44b9-b5bc-57f160046639', impressions: 808094, age: 420, csat: 63, product: 'Viva', theme: 'Viva' },
            { rank: 13, title: 'Viva Glint frequently asked questions', url: 'https://support.microsoft.com/en-us/topic/e2db8792-d4a3-4e73-84e9-7161fb18fa7d', impressions: 720695, age: 321, csat: 78, product: 'Viva', theme: 'Viva Glint' },
            { rank: 14, title: 'Examples of common formulas in lists', url: 'https://support.microsoft.com/en-us/topic/d81f5f21-2b4e-45ce-b170-bf7ebf6988b3', impressions: 694287, age: 516, csat: 46, product: 'SharePoint', theme: 'SharePoint lists and libraries' },
            { rank: 15, title: 'Restore deleted items from the site collection recycle bin', url: 'https://support.microsoft.com/en-us/topic/5fa924ee-16d7-487b-9a0a-021b9062d14b', impressions: 663308, age: 341, csat: 57, product: 'SharePoint', theme: 'File management' },
            { rank: 16, title: 'Restore items in the recycle bin that were deleted from SharePoint or Teams', url: 'https://support.microsoft.com/en-us/topic/6df466b6-55f2-4898-8d6e-c0dff851a0be', impressions: 629773, age: 350, csat: 46, product: 'SharePoint', theme: 'File management' },
            { rank: 17, title: 'View SharePoint files in File Explorer', url: 'https://support.microsoft.com/en-us/topic/66b574bb-08b4-46b6-a6a0-435fd98194cc', impressions: 626769, age: 383, csat: 38, product: 'SharePoint', theme: 'File management' },
            { rank: 18, title: 'Share SharePoint files or folders', url: 'https://support.microsoft.com/en-us/topic/1fe37332-0f9a-4719-970e-d2578da4941c', impressions: 596196, age: 414, csat: 51, product: 'SharePoint', theme: 'Collaborate and share' },
            { rank: 19, title: 'Discover content with the SharePoint start page', url: 'https://support.microsoft.com/en-us/topic/6b85097a-87e0-4611-a29a-dfd49b1a1220', impressions: 567214, age: 589, csat: 42, product: 'SharePoint', theme: 'SharePoint pages' },
            { rank: 20, title: 'SharePoint mobile app sign in options', url: 'https://support.microsoft.com/en-us/topic/fc002093-6a1a-41bf-b9d1-7e217c1cc7b6', impressions: 562137, age: 365, csat: 57, product: 'SharePoint', theme: 'Sign in' },
            { rank: 21, title: 'Viewing SharePoint start page with Microsoft Graph turned off', url: 'https://support.microsoft.com/en-us/topic/3eb40fe7-6be9-4dca-a9f2-ad3e39bf28b0', impressions: 552386, age: 396, csat: 64, product: 'SharePoint', theme: 'SharePoint pages' },
            { rank: 22, title: 'Change the look of your SharePoint site', url: 'https://support.microsoft.com/en-us/topic/06bbadc3-6b04-4a60-9d14-894f6a170818', impressions: 531873, age: 266, csat: 55, product: 'SharePoint', theme: 'Customization' },
            { rank: 23, title: 'Use the SharePoint Standard communication, Showcase, and Blank communication site templates', url: 'https://support.microsoft.com/en-us/topic/94a33429-e580-45c3-a090-5512a8070732', impressions: 518596, age: 275, csat: 57, product: 'SharePoint', theme: 'Templates' },
            { rank: 24, title: 'Change your personal language and region settings', url: 'https://support.microsoft.com/en-us/topic/caa1fccc-bcdb-42f3-9e5b-45957647ffd7', impressions: 504175, age: 254, csat: 44, product: 'SharePoint', theme: 'Language and translation' },
            { rank: 25, title: 'Customize permissions for a SharePoint list or library', url: 'https://support.microsoft.com/en-us/topic/02d770f3-59eb-4910-a608-5f84cc297782', impressions: 502812, age: 352, csat: 37, product: 'SharePoint', theme: 'Customization' },
            { rank: 26, title: 'SharePoint Alerts retirement', url: 'https://support.microsoft.com/en-us/topic/813a90c7-3ff1-47a9-8a2f-152f48b2486f', impressions: 501577, age: 255, csat: 54, product: 'SharePoint', theme: 'Alerts' },
            { rank: 27, title: 'Sign in to Viva Engage', url: 'https://support.microsoft.com/en-us/topic/d863154a-4223-4ea2-8855-ccc971321b8e', impressions: 471357, age: 69, csat: 50, product: 'Viva', theme: 'Sign in' },
            { rank: 28, title: 'SharePoint help & learning', url: 'https://support.microsoft.com/en-us/sharepoint', impressions: 431264, age: 426, csat: null, product: 'SharePoint', theme: 'Help' },
            { rank: 29, title: 'Not getting the search results you\'re looking for in SharePoint?', url: 'https://support.microsoft.com/en-us/topic/d80687f7-1010-4e6d-add9-584b423289d9', impressions: 411364, age: 642, csat: 45, product: 'SharePoint', theme: 'Search' },
            { rank: 30, title: 'Apply and customize SharePoint site templates', url: 'https://support.microsoft.com/en-us/topic/39382463-0e45-4d1b-be27-0e96aeec8398', impressions: 399614, age: 617, csat: 60, product: 'SharePoint', theme: 'Customization' },
            { rank: 31, title: 'Sync SharePoint and Teams files with your computer', url: 'https://support.microsoft.com/en-us/topic/6de9ede8-5b6e-4503-80b2-6190f3354a88', impressions: 394529, age: 349, csat: 43, product: 'SharePoint', theme: 'File management' },
            { rank: 32, title: 'Customize the navigation on your SharePoint site', url: 'https://support.microsoft.com/en-us/topic/3cd61ae7-a9ed-4e1e-bf6d-4655f0bf25ca', impressions: 391213, age: 314, csat: 41, product: 'SharePoint', theme: 'Customization' },
            { rank: 33, title: 'Create a list', url: 'https://support.microsoft.com/en-us/topic/0d397414-d95f-41eb-addd-5e6eff41b083', impressions: 389956, age: 408, csat: 54, product: 'SharePoint', theme: 'SharePoint lists and libraries' },
            { rank: 34, title: 'Manage sites in the SharePoint admin center', url: 'https://learn.microsoft.com/en-us/sharepoint/manage-sites-in-new-admin-center', impressions: 388134, age: 279, csat: 64, product: 'SharePoint', theme: 'Administration' },
            { rank: 35, title: 'Create a rule to automate a list or library', url: 'https://support.microsoft.com/en-us/topic/151ea008-7fa6-409b-b0bd-b04a3b3cacd5', impressions: 374178, age: 516, csat: 56, product: 'SharePoint', theme: 'SharePoint lists and libraries' },
            { rank: 36, title: 'Sharing and permissions', url: 'https://support.microsoft.com/en-us/topic/ac85fbf1-2431-49bf-8690-f1a2b98af65f', impressions: 367297, age: 496, csat: 44, product: 'SharePoint', theme: 'Collaborate and share' },
            { rank: 37, title: 'What is SharePoint?', url: 'https://support.microsoft.com/en-us/topic/97b915e6-651b-43b2-827d-fb25777f446f', impressions: 365477, age: 349, csat: 59, product: 'SharePoint', theme: 'Get started' },
            { rank: 38, title: 'Change SharePoint online language settings', url: 'https://support.microsoft.com/en-us/topic/0f6a477a-dcab-4462-9d0c-e3b53d138183', impressions: 364657, age: 252, csat: 54, product: 'SharePoint', theme: 'Account management' },
            { rank: 39, title: 'Create a site in SharePoint', url: 'https://support.microsoft.com/en-us/topic/4d1e11bf-8ddc-499d-b889-2b48d10b1ce8', impressions: 357416, age: 617, csat: 50, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 40, title: 'Introduction to SharePoint and OneDrive in Microsoft 365 for administrators', url: 'https://learn.microsoft.com/en-us/sharepoint/introduction', impressions: 334315, age: 279, csat: 68, product: 'SharePoint', theme: 'Administration' },
            { rank: 41, title: 'Create a team site in SharePoint', url: 'https://support.microsoft.com/en-us/topic/ef10c1e7-15f3-42a3-98aa-b5972711777d', impressions: 323858, age: 601, csat: 69, product: 'SharePoint', theme: 'SharePoint sites' },
            { rank: 42, title: 'External or guest sharing in OneDrive, SharePoint, and Lists', url: 'https://support.microsoft.com/en-us/topic/7aa070b8-d094-4921-9dd9-86392f2a79e7', impressions: 323826, age: null, csat: 41, product: 'SharePoint', theme: 'Collaborate and share' },
            { rank: 43, title: 'Manage sharing settings for SharePoint and OneDrive in Microsoft 365', url: 'https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off', impressions: 319471, age: 34, csat: 43, product: 'SharePoint', theme: 'Administration' },
            { rank: 44, title: 'Sync SharePoint files and folders', url: 'https://support.microsoft.com/en-us/topic/87a96948-4dd7-43e4-aca1-53f3e18bea9b', impressions: 312084, age: 390, csat: 40, product: 'SharePoint', theme: 'File management' },
            { rank: 45, title: 'Section Design Ideas', url: 'https://support.microsoft.com/en-us/topic/1da23de6-3033-4719-98ac-9394a504cc77', impressions: 309883, age: null, csat: 61, product: 'SharePoint', theme: 'SharePoint pages' },
            { rank: 46, title: 'SharePoint video training', url: 'https://support.microsoft.com/en-us/topic/cb8ef501-84db-4427-ac77-ec2009fb8e23', impressions: 304680, age: 20, csat: 67, product: 'SharePoint', theme: 'Get started' },
            { rank: 47, title: 'View the version history of an item or file in a list or library', url: 'https://support.microsoft.com/en-us/topic/53262060-5092-424d-a50b-c798b0ec32b1', impressions: 298978, age: 610, csat: 26, product: 'SharePoint', theme: 'SharePoint lists and libraries' },
            { rank: 48, title: 'Using web parts on SharePoint pages', url: 'https://support.microsoft.com/en-us/topic/336e8e92-3e2d-4298-ae01-d404bbe751e0', impressions: 296374, age: 160, csat: 55, product: 'SharePoint', theme: 'SharePoint pages' },
            { rank: 49, title: 'Manage your Viva Engage notifications', url: 'https://support.microsoft.com/en-us/topic/93e530e0-189f-4768-8f28-7683d48cc996', impressions: 289492, age: 44, csat: 39, product: 'Viva', theme: 'Viva Engage' },
            { rank: 50, title: 'Sharing files, folders, and list items', url: 'https://support.microsoft.com/en-us/topic/e923c4f0-89f5-4cf0-8948-391e31fc0b30', impressions: 276261, age: 39, csat: 52, product: 'SharePoint', theme: 'Collaborate and share' }
        ];

        // Overview data
        const themeData = [
            { name: 'powershell', count: 2251, pct: 25.39 },
            { name: 'Updates', count: 1626, pct: 18.34 },
            { name: 'sharepoint', count: 1578, pct: 17.80 },
            { name: 'viva', count: 879, pct: 9.92 },
            { name: 'microsoft-365', count: 243, pct: 2.74 },
            { name: 'Lists and libraries', count: 173, pct: 1.95 },
            { name: 'Formulas/functions', count: 129, pct: 1.46 },
            { name: 'Viva Engage', count: 93, pct: 1.05 },
            { name: 'File management', count: 73, pct: 0.82 },
            { name: 'SharePoint sites', count: 71, pct: 0.80 }
        ];

        const freshnessData = [
            { label: '> 365 days (STALE)', count: 7689, pct: 86.73, severity: 'critical' },
            { label: '271-365 days', count: 467, pct: 5.27, severity: 'high' },
            { label: '181-270 days', count: 269, pct: 3.03, severity: 'medium' },
            { label: '91-180 days', count: 277, pct: 3.12, severity: 'medium' },
            { label: '0-90 days (FRESH)', count: 161, pct: 1.82, severity: 'low' }
        ];

        // Helper functions
        function formatNumber(num) {
            return num.toLocaleString();
        }

        function getAgeBadgeClass(age) {
            if (age > 730) return 'badge-critical';
            if (age > 365) return 'badge-high';
            if (age > 180) return 'badge-medium';
            return 'badge-low';
        }

        function getCSATBadgeClass(csat) {
            if (csat === 0 || csat === null) return 'badge-zero';
            if (csat < 40) return 'badge-critical';
            if (csat < 50) return 'badge-high';
            if (csat < 60) return 'badge-medium';
            return 'badge-low';
        }

        // Owner assignment functions
        function getPageOwners() {
            const stored = localStorage.getItem('pageOwners');
            return stored ? JSON.parse(stored) : {};
        }

        function setPageOwner(rank, owner) {
            const owners = getPageOwners();
            owners[rank] = owner.trim();
            localStorage.setItem('pageOwners', JSON.stringify(owners));
        }

        function getAllOwnerNames() {
            const owners = getPageOwners();
            const uniqueNames = [...new Set(Object.values(owners).filter(name => name.length > 0))];
            return uniqueNames.sort();
        }

        function updateOwnerSuggestions() {
            const datalist = document.getElementById('ownerSuggestions');
            if (datalist) {
                const names = getAllOwnerNames();
                datalist.innerHTML = names.map(name => `<option value="${name}">`).join('');
            }
        }

        // View rendering functions
        function renderOverview() {
            return `
                <div class="view-header">
                    <h2>üìä Overview - Key Metrics</h2>
                    <p>High-level analysis of 8,865 documentation assets</p>
                </div>

                <div class="chart-container">
                    <h3>Content Freshness Distribution</h3>
                    <div class="bar-chart">
                        ${freshnessData.map(item => `
                            <div class="bar-item">
                                <div class="bar-label">${item.label}</div>
                                <div class="bar" style="width: ${item.pct}%;">
                                    <span class="bar-value">${formatNumber(item.count)} (${item.pct}%)</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="highlight-box">
                        <strong>‚ö†Ô∏è Critical Finding:</strong> 7,689 pages (87%) haven't been updated in over a year
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Top 10 Themes by Asset Count</h3>
                    <div class="bar-chart">
                        ${themeData.map(item => `
                            <div class="bar-item">
                                <div class="bar-label">${item.name}</div>
                                <div class="bar" style="width: ${(item.count / 2251 * 100)}%;">
                                    <span class="bar-value">${formatNumber(item.count)} (${item.pct}%)</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Product Distribution</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Asset Count</th>
                                <th>Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SharePoint</strong></td>
                                <td>7,578</td>
                                <td>85.5%</td>
                            </tr>
                            <tr>
                                <td><strong>Viva</strong></td>
                                <td>1,285</td>
                                <td>14.5%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderPhased() {
            const top50Traffic = trafficData.reduce((sum, p) => sum + p.impressions, 0);
            const totalTraffic = 95331974; // Estimated total traffic across all 8,865 pages

            // Phase boundaries based on cumulative traffic
            const phase1Pages = trafficData.slice(0, 6);  // Pages 1-6 ‚Üí 25.9% coverage
            const phase2Pages = trafficData.slice(6, 25); // Pages 7-25 ‚Üí 40.2% cumulative
            const phase3Pages = trafficData.slice(25, 50); // Pages 26-50 ‚Üí 49.6% cumulative

            const phase1Traffic = phase1Pages.reduce((sum, p) => sum + p.impressions, 0);
            const phase2Traffic = phase2Pages.reduce((sum, p) => sum + p.impressions, 0);
            const phase3Traffic = phase3Pages.reduce((sum, p) => sum + p.impressions, 0);

            const renderPhaseSection = (title, pages, traffic, coverage, color, description) => `
                <div class="chart-container" style="border-left: 6px solid ${color};">
                    <h3 style="color: ${color};">${title}</h3>
                    <p style="font-size: 1.1em; margin-bottom: 20px;">${description}</p>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div style="background: linear-gradient(135deg, ${color}15 0%, ${color}05 100%); padding: 20px; border-radius: 8px; border: 2px solid ${color};">
                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Pages to Update</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: ${color};">${pages.length}</div>
                        </div>
                        <div style="background: linear-gradient(135deg, ${color}15 0%, ${color}05 100%); padding: 20px; border-radius: 8px; border: 2px solid ${color};">
                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Traffic Coverage</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: ${color};">${coverage}%</div>
                        </div>
                        <div style="background: linear-gradient(135deg, ${color}15 0%, ${color}05 100%); padding: 20px; border-radius: 8px; border: 2px solid ${color};">
                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">Monthly Views</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: ${color};">${(traffic / 1000000).toFixed(1)}M</div>
                        </div>
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Page Title</th>
                                <th>Monthly Views</th>
                                <th>Days Old</th>
                                <th>CSAT</th>
                                <th>Owner</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${pages.map(page => {
                                const owners = getPageOwners();
                                const currentOwner = owners[page.rank] || '';
                                return `
                                <tr>
                                    <td><span class="rank-badge">${page.rank}</span></td>
                                    <td><strong><a href="${page.url}" target="_blank" style="color: #667eea; text-decoration: none;">${page.title}</a></strong></td>
                                    <td>${formatNumber(page.impressions)}</td>
                                    <td><span class="badge ${getAgeBadgeClass(page.age)}">${page.age || 'N/A'} days</span></td>
                                    <td><span class="badge ${getCSATBadgeClass(page.csat)}">${page.csat || 'N/A'}</span></td>
                                    <td>
                                        <input
                                            type="text"
                                            value="${currentOwner}"
                                            placeholder="Assign owner..."
                                            style="width: 150px; padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9em;"
                                            onchange="setPageOwner(${page.rank}, this.value)"
                                            list="ownerSuggestions"
                                        />
                                    </td>
                                </tr>
                            `}).join('')}
                        </tbody>
                    </table>
                </div>
            `;

            return `
                <div class="view-header">
                    <h2>üéØ 3-Phase Execution Plan</h2>
                    <p>Strategic phased approach to maximize user impact while managing workload</p>
                </div>

                <div class="highlight-box" style="background: #e8f5e9; border-left-color: #4caf50;">
                    <strong>üí° Strategy:</strong> Focus on highest-impact pages first. Phase 1 reaches 26% of users with just 6 pages.
                    Phase 2 adds 19 pages to reach 40%. Phase 3 completes the top 50 for 50% total coverage.
                </div>

                <div style="background: white; padding: 25px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-top: 0;">üìà Cumulative Progress</h3>
                    <div style="display: flex; gap: 20px; margin-top: 20px;">
                        <div style="flex: 1; text-align: center; padding: 20px; background: #f1f8e9; border-radius: 8px;">
                            <div style="font-size: 3em; font-weight: bold; color: #7cb342;">26%</div>
                            <div style="color: #666;">After Phase 1</div>
                        </div>
                        <div style="flex: 1; text-align: center; padding: 20px; background: #fff3e0; border-radius: 8px;">
                            <div style="font-size: 3em; font-weight: bold; color: #fb8c00;">40%</div>
                            <div style="color: #666;">After Phase 2</div>
                        </div>
                        <div style="flex: 1; text-align: center; padding: 20px; background: #fce4ec; border-radius: 8px;">
                            <div style="font-size: 3em; font-weight: bold; color: #e91e63;">50%</div>
                            <div style="color: #666;">After Phase 3</div>
                        </div>
                    </div>
                </div>

                ${renderPhaseSection(
                    'üöÄ Phase 1: Critical Launch Blockers',
                    phase1Pages,
                    phase1Traffic,
                    '26',
                    '#7cb342',
                    'These 6 pages are your absolute highest priority. Update these BEFORE launch to reach 1 in 4 users.'
                )}

                ${renderPhaseSection(
                    '‚ö° Phase 2: High-Impact Quick Wins',
                    phase2Pages,
                    phase2Traffic,
                    '40',
                    '#fb8c00',
                    'Next 19 pages add significant reach. Complete within 2-3 weeks post-launch to hit 40% coverage.'
                )}

                ${renderPhaseSection(
                    'üì¶ Phase 3: Long Tail Optimization',
                    phase3Pages,
                    phase3Traffic,
                    '50',
                    '#e91e63',
                    'Final 25 pages complete the top 50. Lower individual impact but collectively reaches 50% of all users.'
                )}
            `;
        }

        function renderRoadmap() {
            const totalPages = 8865;
            const totalTraffic = 95331974;

            return `
                <div class="view-header">
                    <h2>üó∫Ô∏è Complete Roadmap to 80% & 100% Coverage</h2>
                    <p>Long-term strategy for comprehensive documentation refresh</p>
                </div>

                <div class="highlight-box" style="background: #e3f2fd; border-left-color: #2196f3;">
                    <strong>‚ö†Ô∏è Reality Check:</strong> Current dashboard shows top 50 pages (50% coverage).
                    Beyond this, diminishing returns make 100% coverage impractical. Focus on 80% as the realistic goal.
                </div>

                <div style="background: white; padding: 30px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-top: 0; color: #2196f3;">üìä Coverage Roadmap Overview</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-top: 25px;">
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #2e7d32;">50%</div>
                            <div style="color: #1b5e20; font-weight: 600; margin-top: 5px;">Top 50 pages</div>
                            <div style="color: #2e7d32; font-size: 0.9em; margin-top: 5px;">‚úÖ Current</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #f57f17;">60%</div>
                            <div style="color: #f57f17; font-weight: 600; margin-top: 5px;">+50 pages (100 total)</div>
                            <div style="color: #f57f17; font-size: 0.9em; margin-top: 5px;">Phase 4</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #ffe0b2 0%, #ffcc80 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #e65100;">70%</div>
                            <div style="color: #e65100; font-weight: 600; margin-top: 5px;">+100 pages (200 total)</div>
                            <div style="color: #e65100; font-size: 0.9em; margin-top: 5px;">Phase 5</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #ffccbc 0%, #ffab91 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #bf360c;">80%</div>
                            <div style="color: #bf360c; font-weight: 600; margin-top: 5px;">+300 pages (500 total)</div>
                            <div style="color: #bf360c; font-size: 0.9em; margin-top: 5px;">Phase 6</div>
                        </div>
                        <div style="text-align: center; padding: 25px; background: linear-gradient(135deg, #f8bbd0 0%, #f48fb1 100%); border-radius: 10px; box-shadow: 0 3px 6px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5em; font-weight: bold; color: #880e4f;">100%</div>
                            <div style="color: #880e4f; font-weight: 600; margin-top: 5px;">All 8,865 pages</div>
                            <div style="color: #880e4f; font-size: 0.9em; margin-top: 5px;">‚ö†Ô∏è Not Recommended</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #7cb342;">
                    <h3 style="color: #7cb342;">‚úÖ PHASES 1-3: COMPLETED (50% Coverage)</h3>
                    <p style="font-size: 1.1em;">First 50 pages - Current dashboard scope</p>
                    <div style="background: #f1f8e9; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 50<br>
                                <strong>Coverage:</strong> 50% of users<br>
                                <strong>Traffic:</strong> 47.3M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 6-8 weeks<br>
                                <strong>Team Size:</strong> 8-10 writers<br>
                                <strong>Status:</strong> <span style="color: #7cb342; font-weight: bold;">‚úÖ Planned</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Excellent<br>
                                <strong>Priority:</strong> Critical<br>
                                <strong>Timeline:</strong> Pre-launch
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #fdd835;">
                    <h3 style="color: #f57f17;">üìã PHASE 4: 60% Coverage (Pages 51-100)</h3>
                    <p style="font-size: 1.1em;">Next 50 pages - Additional 10% coverage</p>
                    <div style="background: #fffde7; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 50 (51-100)<br>
                                <strong>Additional Coverage:</strong> +10%<br>
                                <strong>Additional Traffic:</strong> ~9.5M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 3-4 weeks<br>
                                <strong>Team Size:</strong> 5-6 writers<br>
                                <strong>Status:</strong> <span style="color: #f57f17; font-weight: bold;">üìÖ Future</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Good<br>
                                <strong>Priority:</strong> High<br>
                                <strong>Timeline:</strong> Q1 post-launch
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #ff9800;">
                    <h3 style="color: #e65100;">üìã PHASE 5: 70% Coverage (Pages 101-200)</h3>
                    <p style="font-size: 1.1em;">Next 100 pages - Additional 10% coverage</p>
                    <div style="background: #fff3e0; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 100 (101-200)<br>
                                <strong>Additional Coverage:</strong> +10%<br>
                                <strong>Additional Traffic:</strong> ~9.5M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 6-8 weeks<br>
                                <strong>Team Size:</strong> 5-6 writers<br>
                                <strong>Status:</strong> <span style="color: #e65100; font-weight: bold;">üìÖ Future</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Moderate<br>
                                <strong>Priority:</strong> Medium<br>
                                <strong>Timeline:</strong> Q2 post-launch
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #ff5722;">
                    <h3 style="color: #bf360c;">üìã PHASE 6: 80% Coverage (Pages 201-500)</h3>
                    <p style="font-size: 1.1em;">Next 300 pages - Additional 10% coverage</p>
                    <div style="background: #fbe9e7; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 300 (201-500)<br>
                                <strong>Additional Coverage:</strong> +10%<br>
                                <strong>Additional Traffic:</strong> ~9.5M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 12-16 weeks<br>
                                <strong>Team Size:</strong> 4-5 writers<br>
                                <strong>Status:</strong> <span style="color: #bf360c; font-weight: bold;">üìÖ Future</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Low-Moderate<br>
                                <strong>Priority:</strong> Medium-Low<br>
                                <strong>Timeline:</strong> Q3-Q4 post-launch
                            </div>
                        </div>
                    </div>
                    <div style="background: #fff9c4; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #f57f17;">
                        <strong>üí° Recommended Goal:</strong> This 80% coverage (500 pages) is the optimal stopping point for most teams.
                    </div>
                </div>

                <div class="chart-container" style="border-left: 6px solid #e91e63;">
                    <h3 style="color: #880e4f;">‚ö†Ô∏è PHASE 7: 100% Coverage (Pages 501-8,865)</h3>
                    <p style="font-size: 1.1em;">Remaining 8,365 pages - Final 20% coverage</p>
                    <div style="background: #fce4ec; padding: 20px; border-radius: 6px; margin-top: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div>
                                <strong>Pages:</strong> 8,365 (501-8,865)<br>
                                <strong>Additional Coverage:</strong> +20%<br>
                                <strong>Additional Traffic:</strong> ~19M views/month
                            </div>
                            <div>
                                <strong>Effort:</strong> 2-3 YEARS<br>
                                <strong>Team Size:</strong> 10+ writers<br>
                                <strong>Status:</strong> <span style="color: #880e4f; font-weight: bold;">‚ùå Not Viable</span>
                            </div>
                            <div>
                                <strong>ROI:</strong> Negative<br>
                                <strong>Priority:</strong> Very Low<br>
                                <strong>Timeline:</strong> Ongoing/Never
                            </div>
                        </div>
                    </div>
                    <div style="background: #ffcdd2; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #d32f2f;">
                        <strong>‚ö†Ô∏è Reality:</strong> These 8,365 pages average <100 views/month each. Many are obsolete, rarely viewed, or duplicate content.
                        Better strategy: Let these age naturally and update only when product changes require it.
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 12px; margin-top: 40px;">
                    <h3 style="color: white; margin-top: 0;">üíé Recommended Strategy</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin-top: 20px;">
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                            <h4 style="color: white; margin-top: 0;">Year 1: Focus on 80%</h4>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Phases 1-3: Top 50 pages (50%)</li>
                                <li>Phase 4: Pages 51-100 (60%)</li>
                                <li>Phase 5: Pages 101-200 (70%)</li>
                                <li>Phase 6: Pages 201-500 (80%)</li>
                            </ul>
                            <strong>Result:</strong> 500 pages updated = 80% coverage
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                            <h4 style="color: white; margin-top: 0;">Year 2+: Maintenance Mode</h4>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Quarterly reviews of top 500</li>
                                <li>Update long tail only when needed</li>
                                <li>Archive truly obsolete content</li>
                                <li>Monitor traffic for rising pages</li>
                            </ul>
                            <strong>Result:</strong> Sustainable, high-ROI approach
                        </div>
                    </div>
                </div>
            `;
        }

        function renderOwnership() {
            // Group pages by theme/feature area
            const areaGroups = {};
            trafficData.forEach(page => {
                if (!areaGroups[page.theme]) {
                    areaGroups[page.theme] = [];
                }
                areaGroups[page.theme].push(page);
            });

            // Calculate metrics for each area
            const areaSummary = Object.keys(areaGroups).map(theme => {
                const pages = areaGroups[theme];
                const totalImpressions = pages.reduce((sum, p) => sum + p.impressions, 0);
                const avgAge = Math.round(pages.reduce((sum, p) => sum + (p.age || 0), 0) / pages.length);
                const avgCSAT = Math.round(pages.reduce((sum, p) => sum + (p.csat || 0), 0) / pages.filter(p => p.csat).length);
                const oldPages = pages.filter(p => (p.age || 0) > 365).length;

                return {
                    theme,
                    pageCount: pages.length,
                    totalImpressions,
                    avgAge,
                    avgCSAT,
                    oldPages,
                    pages: pages.sort((a, b) => b.impressions - a.impressions)
                };
            }).sort((a, b) => b.totalImpressions - a.totalImpressions);

            return `
                <div class="view-header">
                    <h2>üë• Product Area Ownership - Divide & Conquer</h2>
                    <p>Group pages by feature area to assign ownership among product managers</p>
                </div>
                <div class="highlight-box">
                    <strong>üéØ Strategy:</strong> ${areaSummary.length} distinct feature areas identified. Each PM can claim 1-2 areas based on domain expertise.
                </div>

                ${areaSummary.map((area, index) => `
                    <div class="chart-container">
                        <h3>${index + 1}. ${area.theme} <span style="color: #667eea;">(${area.pageCount} pages)</span></h3>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #667eea;">
                                <strong style="color: #667eea;">Total Traffic:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${formatNumber(area.totalImpressions)}</span>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #f39c12;">
                                <strong style="color: #f39c12;">Avg Age:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${area.avgAge} days</span>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #e74c3c;">
                                <strong style="color: #e74c3c;">Stale Pages:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${area.oldPages} / ${area.pageCount}</span>
                            </div>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 4px solid #27ae60;">
                                <strong style="color: #27ae60;">Avg CSAT:</strong><br>
                                <span style="font-size: 1.2em; font-weight: bold;">${area.avgCSAT || 'N/A'}</span>
                            </div>
                        </div>

                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Page Title</th>
                                    <th>Monthly Views</th>
                                    <th>Days Old</th>
                                    <th>CSAT</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${area.pages.slice(0, 10).map((page, idx) => `
                                    <tr>
                                        <td><span class="rank-badge">${idx + 1}</span></td>
                                        <td><strong><a href="${page.url}" target="_blank" style="color: #667eea; text-decoration: none;">${page.title}</a></strong></td>
                                        <td>${formatNumber(page.impressions)}</td>
                                        <td><span class="badge ${getAgeBadgeClass(page.age)}">${page.age || 'N/A'} days</span></td>
                                        <td><span class="badge ${getCSATBadgeClass(page.csat)}">${page.csat || 'N/A'}</span></td>
                                    </tr>
                                `).join('')}
                                ${area.pages.length > 10 ? `
                                    <tr>
                                        <td colspan="5" style="text-align: center; color: #999; font-style: italic;">
                                            ... and ${area.pages.length - 10} more pages in this area
                                        </td>
                                    </tr>
                                ` : ''}
                            </tbody>
                        </table>
                    </div>
                `).join('')}
            `;
        }

        function renderTraffic() {
            return `
                <div class="view-header">
                    <h2>üî• Top 50 Pages by Traffic</h2>
                    <p>Highest impression pages - prioritize for maximum user impact</p>
                </div>
                <div class="highlight-box">
                    <strong>üí° Impact:</strong> These 50 pages capture 49.6% of all documentation traffic
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Product</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${trafficData.map(item => `
                            <tr>
                                <td><span class="rank-badge">${item.rank}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.product}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderFreshness() {
            const oldestPages = [...trafficData].sort((a, b) => (b.age || 0) - (a.age || 0)).slice(0, 50);
            return `
                <div class="view-header">
                    <h2>‚è∞ Top 50 Most Outdated Pages</h2>
                    <p>Oldest content that hasn't been reviewed - highest staleness risk</p>
                </div>
                <div class="highlight-box">
                    <strong>‚ö†Ô∏è Alert:</strong> Average age of these pages is ${Math.round(oldestPages.reduce((sum, p) => sum + (p.age || 0), 0) / oldestPages.length)} days (${(oldestPages.reduce((sum, p) => sum + (p.age || 0), 0) / oldestPages.length / 365).toFixed(1)} years)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Days Old</th>
                            <th>Years Old</th>
                            <th>Monthly Views</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${oldestPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td>${item.age ? (item.age / 365).toFixed(1) : 'N/A'} yrs</td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderCSAT() {
            const lowCSAT = [...trafficData].sort((a, b) => a.csat - b.csat).slice(0, 50);
            return `
                <div class="view-header">
                    <h2>üòû Top 50 Lowest CSAT Pages</h2>
                    <p>Pages with lowest user satisfaction - address user pain points</p>
                </div>
                <div class="highlight-box">
                    <strong>üìâ User Feedback:</strong> Average CSAT of ${Math.round(lowCSAT.reduce((sum, p) => sum + (p.csat || 0), 0) / lowCSAT.length)}/100 indicates significant user dissatisfaction
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>CSAT Score</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${lowCSAT.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}/100</span></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderNeverReviewed() {
            return `
                <div class="view-header">
                    <h2>‚ö†Ô∏è Never Reviewed Content</h2>
                    <p>4,911 pages (55% of all content) have never been reviewed - highest risk</p>
                </div>
                <div class="highlight-box">
                    <strong>üö® Critical Risk:</strong> Over half of all documentation has never undergone a formal review process. These pages represent the highest risk for outdated or inaccurate information.
                </div>
                <div class="chart-container">
                    <h3>Never Reviewed Content Statistics</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Value</th>
                                <th>Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Total Never Reviewed</strong></td>
                                <td>4,911 pages</td>
                                <td>55.4% of all content</td>
                            </tr>
                            <tr>
                                <td><strong>SharePoint Pages</strong></td>
                                <td>4,234 pages</td>
                                <td>55.9% of SharePoint content</td>
                            </tr>
                            <tr>
                                <td><strong>Viva Pages</strong></td>
                                <td>677 pages</td>
                                <td>52.7% of Viva content</td>
                            </tr>
                            <tr>
                                <td><strong>Estimated Age</strong></td>
                                <td>3+ years average</td>
                                <td>High staleness risk</td>
                            </tr>
                            <tr>
                                <td><strong>Recommendation</strong></td>
                                <td colspan="2">Prioritize technical content and high-traffic pages from this group</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="highlight-box">
                    <strong>üìã Next Steps:</strong> Cross-reference never-reviewed pages with high traffic and critical themes to identify immediate priorities
                </div>
            `;
        }

        function renderSharePoint() {
            const spPages = trafficData.filter(p => p.product === 'SharePoint').slice(0, 50);
            return `
                <div class="view-header">
                    <h2>üì¶ SharePoint Content Only</h2>
                    <p>Top 50 SharePoint pages - 7,578 total assets (85.5%)</p>
                </div>
                <div class="highlight-box">
                    <strong>üìä SharePoint Focus:</strong> 85.5% of all documentation is SharePoint-related (7,578 pages)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${spPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderViva() {
            const vivaPages = trafficData.filter(p => p.product === 'Viva');
            return `
                <div class="view-header">
                    <h2>üéØ Viva Content Only</h2>
                    <p>Top Viva pages - 1,285 total assets (14.5%)</p>
                </div>
                <div class="highlight-box">
                    <strong>üéØ Viva Focus:</strong> 1,285 Viva-related pages (14.5% of all documentation)
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                            <th>Theme</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${vivaPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                                <td>${item.theme}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderSignIn() {
            const signinPages = trafficData.filter(p => p.theme.toLowerCase().includes('sign in') || p.theme.toLowerCase().includes('authentication'));
            return `
                <div class="view-header">
                    <h2>üîê Sign In & Authentication Theme</h2>
                    <p>All pages related to sign-in and authentication</p>
                </div>
                <div class="highlight-box">
                    <strong>üîê Top Theme:</strong> Sign-in pages are among the highest traffic - critical for user experience
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${signinPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderModern() {
            const modernPages = trafficData.filter(p => p.theme.toLowerCase().includes('modern'));
            return `
                <div class="view-header">
                    <h2>üé® Modern Pages & Sites Theme</h2>
                    <p>All pages related to modern SharePoint experience</p>
                </div>
                <div class="highlight-box">
                    <strong>üé® Modern Experience:</strong> These pages cover the modern SharePoint UI and features
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${modernPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderSharing() {
            const sharingPages = trafficData.filter(p => p.theme.toLowerCase().includes('sharing') || p.theme.toLowerCase().includes('collaboration'));
            return `
                <div class="view-header">
                    <h2>ü§ù Sharing & Collaboration Theme</h2>
                    <p>All pages related to sharing files, folders, and collaboration</p>
                </div>
                <div class="highlight-box">
                    <strong>ü§ù Core Feature:</strong> Sharing is a fundamental capability - high traffic and user engagement
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${sharingPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function renderLists() {
            const listPages = trafficData.filter(p => p.theme.toLowerCase().includes('lists') || p.theme.toLowerCase().includes('libraries'));
            return `
                <div class="view-header">
                    <h2>üìã Lists & Libraries Theme</h2>
                    <p>All pages related to SharePoint lists and document libraries</p>
                </div>
                <div class="highlight-box">
                    <strong>üìã Power User Content:</strong> Lists and libraries are core SharePoint features with significant technical depth
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Page Title</th>
                            <th>Monthly Views</th>
                            <th>Days Old</th>
                            <th>CSAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${listPages.map((item, index) => `
                            <tr>
                                <td><span class="rank-badge">${index + 1}</span></td>
                                <td><strong><a href="${item.url}" target="_blank" style="color: #667eea; text-decoration: none;">${item.title}</a></strong></td>
                                <td>${formatNumber(item.impressions)}</td>
                                <td><span class="badge ${getAgeBadgeClass(item.age)}">${item.age || 'N/A'} days</span></td>
                                <td><span class="badge ${getCSATBadgeClass(item.csat)}">${item.csat || 'N/A'}</span></td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // Main view switching function
        function changeView() {
            console.log('changeView() called');
            const selector = document.getElementById('viewSelector');
            const content = document.getElementById('content');
            const view = selector.value;
            console.log('Selected view:', view);

            const viewFunctions = {
                'overview': renderOverview,
                'phased': renderPhased,
                'roadmap': renderRoadmap,
                'ownership': renderOwnership,
                'traffic': renderTraffic,
                'freshness': renderFreshness,
                'csat': renderCSAT,
                'never-reviewed': renderNeverReviewed,
                'sharepoint': renderSharePoint,
                'viva': renderViva,
                'signin': renderSignIn,
                'modern': renderModern,
                'sharing': renderSharing,
                'lists': renderLists
            };

            if (viewFunctions[view]) {
                console.log('Rendering view:', view);
                const html = viewFunctions[view]();
                console.log('Generated HTML length:', html.length);
                content.innerHTML = html;
                console.log('Content updated');

                // Update owner suggestions for phased and roadmap views
                if (view === 'phased' || view === 'roadmap') {
                    updateOwnerSuggestions();
                }

                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                console.error('View function not found for:', view);
            }
        }

        // Initialize with overview
        window.onload = function() {
            console.log('Window loaded!');
            try {
                const content = document.getElementById('content');
                const selector = document.getElementById('viewSelector');
                console.log('Content element:', content);
                console.log('Selector element:', selector);
                console.log('Calling changeView()...');
                changeView();
                console.log('Dashboard loaded successfully!');
            } catch (error) {
                console.error('Error loading dashboard:', error);
            }
        };
    </script>
</body>
</html>
